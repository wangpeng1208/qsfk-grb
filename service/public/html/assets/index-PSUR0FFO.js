import{d as W,e as h,m as H,r as J,o as u,c as y,w as t,g as S,a,u as l,b as c,p as v,t as Q,n as w,D as k,M as m,x as X,B as Y}from"./index-DyfhlEKp.js";import{d as L,c as Z,f as ee,l as te}from"./card-fSVW16ud.js";import{l as oe}from"./category-D2kcqz8R.js";import{g as ae}from"./good-B793QrHd.js";import ie from"./index-DJuGdIKJ.js";import{t as re}from"./table-BF9w5i7h.js";import{f as se}from"./date-DPLtFlJd.js";import le from"./detail-BCyfk6dw.js";import ne from"./search-BUcBwgzl.js";import{S as ce}from"./index-Bwp-2Qz8.js";import{I as me}from"./index-DB8QFTGe.js";import{S as de}from"./index-SBfgDntf.js";import{I as pe}from"./index-D6uIAV1D.js";import{T as ue}from"./index-BqUjqorV.js";import{L as fe}from"./index-C7ePc3Rn.js";import{T as _e}from"./index-BljZbolB.js";import{C as ge}from"./index-BtWSimco.js";import{_ as he}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./global-DaymibWd.js";import"./index-DWHfpBzf.js";import"./index-0JxUx2HH.js";import"./useLengthLimit-DKh2E-5w.js";import"./log-ZJhmUOBa.js";import"./dep-02de0cb4-VTr6AM5L.js";import"./dep-4cc4ef27-CAGvppEF.js";import"./dep-96cefb8b-B7fBVahI.js";import"./index-c2cc7QiC.js";import"./useVModel-CsuQbcSh.js";import"./observe-CfjnoQGd.js";import"./common-CF_MvV9u.js";import"./useReadonly-CXHqkGFp.js";import"./dep-d524834c-s9Vwwbzr.js";import"./slot-cq2gaFzZ.js";import"./index-BD2FLwpo.js";import"./index-Dz3F8iWe.js";import"./useResizeObserver-Cdm0ScvH.js";import"./useDefaultValue-Ddzubvc6.js";import"./close-circle-filled-VWO7_lX7.js";import"./const-BpWshxEh.js";import"./browse-DwSqVlrQ.js";import"./index-B_MhyprB.js";import"./dep-eedf0c29-C1TTFeWr.js";import"./index-DJdMn3qi.js";import"./index-wZPh1Y2_.js";import"./useCommonClassName-DmyQvkIn.js";import"./number-D5fGb371.js";import"./chevron-left-DYfq66NB.js";import"./chevron-right-Cq7dXvRT.js";import"./useVirtualScrollNew-DRIC9GW6.js";import"./dep-af55fe23-B3wLF_kD.js";import"./dep-86139c71-C0IAGQhw.js";import"./index-Yvpn3d-W.js";import"./helper-CJ_b_F_u.js";import"./dep-40320ba3-B1Ayvxeb.js";import"./dep-1858b432-QdwZEHj5.js";import"./form-model-Ba97jzoW.js";const ye=[{colKey:"id",type:"multiple",align:"center",ellipsis:!0},{colKey:"category_name",title:"商品分类",align:"center",ellipsis:!0},{colKey:"good_name",title:"商品名称",align:"center",ellipsis:!0},{colKey:"good_price",title:"商品价格",align:"center",ellipsis:!0},{colKey:"number",title:"卡号",align:"center",ellipsis:!0},{colKey:"secret",title:"卡密",align:"center",ellipsis:!0},{colKey:"status",title:"状态",align:"center",ellipsis:!0},{colKey:"create_at",title:"添加时间",cell(V,g){return V("span",se(g.row.create_at))}},{colKey:"operation",title:"操作",fixed:"right",align:"center",ellipsis:!0,minWidth:125}],Ce=[{label:"锁定中",value:3},{label:"已售出",value:2},{label:"未售出",value:1}],be={class:"category-header"},ve={class:"mb15"},ke={key:0,class:"selected-count"},Ve={key:0,style:{color:"rgb(8, 43, 139)"}},xe={key:1},De={name:"CardIndex"},Ke=W({...De,setup(V){const g=h(),x=h();(async()=>{g.value=(await oe()).data.list??[],x.value=(await ae()).data??[]})();const D=H(),s=J({cate_id:"",goods_id:"",number:"",status:""}),{pagination:T,fetchData:_,dataLoading:$,headerAffixedTop:I,rehandlePageChange:N,lists:O,searchData:P}=re({fetchFun:te,params:s});_();const{query:K}=D.currentRoute.value;Object.keys(K).forEach(o=>{s[o]!==void 0&&(s[o]=Number(K[o]))});const d=h([]),U=o=>{d.value=o},B=h(null),z=async o=>{B.value.init(o)},E=async o=>{const e=k({header:"提醒",body:"是否确认删除？",confirmBtn:"确认",onConfirm:({e:r})=>{e.hide();const{id:n}=o;L({ids:[n]}).then(f=>{f.code===1?(m.success("删除成功"),_()):m.error(`${f.msg}`)}).catch(f=>{m.error("删除失败")})},onClose:({e:r,trigger:n})=>{e.hide()}})},F=X(o=>{const{id:e,is_first:r}=o;ee({id:e,status:r===1?0:1}).then(p=>{p.code===1&&_()})}),G=async()=>{const o=k({header:"提醒",body:"是否确认删除？点击确认后删除的卡密将被放置回收站",confirmBtn:"确认",onConfirm:({e})=>{o.hide();const r={ids:d.value};L(r).then(n=>{n.code===1?(_(),m.success("删除成功"),d.value=[]):m.error(`删除失败：${n.msg}`)}).catch(n=>{m.error("删除失败")})},onClose:({e,trigger:r})=>{o.hide()}})},M=async()=>{const o=k({header:"提醒",body:"确定要清空卡密库存吗？点击确认后，卡密库存将被移至回收站！",confirmBtn:"确认",onConfirm:({e})=>{o.hide(),Z().then(r=>{r.code===1?(_(),m.success("清空成功")):m.error(`清空失败：${r.msg}`)}).catch(r=>{m.error("清空失败")})},onClose:({e,trigger:r})=>{o.hide()}})};return(o,e)=>{const r=ce,n=me,p=Y,f=de,j=pe,C=ue,b=fe,q=_e,A=ge;return u(),y(A,{title:"库存列表",class:"basic-container",bordered:!1},{default:t(()=>[S("div",be,[a(f,null,{default:t(()=>[a(r,{modelValue:s.cate_id,"onUpdate:modelValue":e[0]||(e[0]=i=>s.cate_id=i),placeholder:"全部分类",clearable:"",options:g.value},null,8,["modelValue","options"]),a(r,{modelValue:s.goods_id,"onUpdate:modelValue":e[1]||(e[1]=i=>s.goods_id=i),placeholder:"全部商品",clearable:"",options:x.value,keys:{value:"id",label:"name"}},null,8,["modelValue","options"]),a(r,{modelValue:s.status,"onUpdate:modelValue":e[2]||(e[2]=i=>s.status=i),placeholder:"全部状态",clearable:"",options:l(Ce)},null,8,["modelValue","options"]),a(n,{modelValue:s.number,"onUpdate:modelValue":e[3]||(e[3]=i=>s.number=i),placeholder:"请输入关键词",clearable:""},{"suffix-icon":t(()=>[a(l(ne))]),_:1},8,["modelValue"]),a(p,{theme:"primary",onClick:l(P)},{default:t(()=>[c("查询")]),_:1},8,["onClick"])]),_:1})]),a(q,{data:l(O),columns:l(ye),"row-key":"id",pagination:l(T),"selected-row-keys":d.value,loading:l($),"header-affixed-top":l(I),"max-height":"auto","table-layout":"auto",onPageChange:l(N),onSelectChange:U},{topContent:t(()=>[S("div",ve,[a(p,{theme:"primary",onClick:e[4]||(e[4]=i=>l(D).push("/admin/goods/card/add"))},{icon:t(()=>[a(j,{name:"add"})]),default:t(()=>[c(" 添加库存 ")]),_:1}),a(p,{theme:"danger",onClick:M},{default:t(()=>[c(" 全部清空 ")]),_:1}),a(p,{theme:"default",disabled:!d.value.length,onClick:G},{default:t(()=>[c(" 批量删除 ")]),_:1},8,["disabled"]),d.value.length?(u(),v("p",ke,"已选"+Q(d.value.length)+"项",1)):w("",!0)])]),status:t(({row:i})=>[i.status===2?(u(),y(C,{key:0,variant:"light",theme:"success"},{default:t(()=>[c("已售")]),_:1})):(u(),y(C,{key:1,variant:"light",theme:"danger"},{default:t(()=>[c("未售")]),_:1})),i.is_cross===1?(u(),y(C,{key:2,variant:"light",theme:"success"},{default:t(()=>[c("跨站")]),_:1})):w("",!0)]),operation:t(({row:i})=>[a(f,null,{default:t(()=>[a(b,{size:"small",theme:"primary",hover:"color",onClick:R=>l(F)(i)},{default:t(()=>[i.is_first===1?(u(),v("span",Ve," 取消优先 ")):(u(),v("span",xe," 优先销售 "))]),_:2},1032,["onClick"]),a(b,{size:"small",theme:"primary",hover:"color",onClick:R=>z(i)},{default:t(()=>[c("查看")]),_:2},1032,["onClick"]),a(b,{size:"small",theme:"danger",hover:"color",onClick:R=>E(i)},{default:t(()=>[c("删除")]),_:2},1032,["onClick"])]),_:2},1024)]),empty:t(()=>[a(ie,{title:"",tip:"库存为空",type:"list"})]),_:1},8,["data","columns","pagination","selected-row-keys","loading","header-affixed-top","onPageChange"]),a(le,{ref_key:"cardDetailRef",ref:B},null,512)]),_:1})}}}),wt=he(Ke,[["__scopeId","data-v-f110df86"]]);export{wt as default};
