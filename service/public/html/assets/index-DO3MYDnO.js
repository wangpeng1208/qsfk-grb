import{d as A,e as h,m as W,r as H,o as f,c as C,w as o,g as R,a,u as l,b as m,p as b,t as J,n as Q,D as v,M as c,x as X,B as Y}from"./index-Dys89YLq.js";import{d as S,c as Z,f as ee,l as te}from"./card-CCRv9plg.js";import{l as oe}from"./category-DQvQx6ik.js";import{g as ae}from"./good-BMX4p-GN.js";import ie from"./index-BP1Nendd.js";import{t as re}from"./table-CpEkFG8g.js";import{f as se}from"./date-DY_Aq1Lj.js";import le from"./detail-DD-N-q6n.js";import ne from"./search-RV2LQLXF.js";import{S as ce}from"./index-Ci-WgI1t.js";import{I as me}from"./index-k_yBcVp0.js";import{S as de}from"./index-DwGXmo2C.js";import{I as pe}from"./index-B8o3bOvu.js";import{T as ue}from"./index-BcNem8rV.js";import{L as fe}from"./index-C8u_RSpS.js";import{T as _e}from"./index-DbnGGVSd.js";import{C as ge}from"./index-D8Ix0oeU.js";import{_ as he}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./global-DaymibWd.js";import"./index-9wlLuihG.js";import"./index-Bqwwrko2.js";import"./dep-02de0cb4-_xWusXWA.js";import"./dep-4cc4ef27--AW_KZeX.js";import"./dep-96cefb8b-CiB99TH1.js";import"./index-BTVA41u8.js";import"./useVModel-ChUVkX5D.js";import"./observe-CfjnoQGd.js";import"./common-CF_MvV9u.js";import"./useReadonly-GuO_-cT8.js";import"./dep-d524834c-s9Vwwbzr.js";import"./slot-DKAjzcwC.js";import"./index-BA1slVbh.js";import"./index-CjM8dnKg.js";import"./useResizeObserver-D_uTF440.js";import"./useDefaultValue-pk1y0m3m.js";import"./close-circle-filled-6NKz9kYY.js";import"./log-ZJhmUOBa.js";import"./index-BT8Ia4HF.js";import"./dep-eedf0c29-ErImML_u.js";import"./index-Dka09D2p.js";import"./index-xCa1PnD5.js";import"./useCommonClassName-BZA0SnO7.js";import"./number-B3LVzGws.js";import"./chevron-left-Ca8qIpvl.js";import"./chevron-right-Bz__VYX8.js";import"./useVirtualScrollNew-B7BxRQci.js";import"./dep-af55fe23-hzblXEZ8.js";import"./dep-86139c71-BioGcMu7.js";import"./index-Q2T2ZnL7.js";import"./helper-DDcUnKCP.js";import"./dep-40320ba3-B1Ayvxeb.js";import"./dep-1858b432-DPK9DfHI.js";import"./form-model-CIY_RhMw.js";const ye=[{colKey:"id",type:"multiple",align:"center",ellipsis:!0},{colKey:"category_name",title:"商品分类",align:"center",ellipsis:!0},{colKey:"good_name",title:"商品名称",align:"center",ellipsis:!0},{colKey:"good_price",title:"商品价格",align:"center",ellipsis:!0},{colKey:"number",title:"卡号",align:"center",ellipsis:!0},{colKey:"secret",title:"卡密",align:"center",ellipsis:!0},{colKey:"status",title:"状态",align:"center",ellipsis:!0},{colKey:"create_at",title:"添加时间",cell(k,g){return k("span",se(g.row.create_at))}},{colKey:"operation",title:"操作",fixed:"right",align:"center",ellipsis:!0,minWidth:125}],Ce=[{label:"已售出",value:2},{label:"未售出",value:1}],be={class:"category-header"},ve={class:"mb15"},ke={key:0,class:"selected-count"},Ve={key:0,style:{color:"rgb(8, 43, 139)"}},xe={key:1},De={name:"CardIndex"},Ke=A({...De,setup(k){const g=h(),V=h();(async()=>{g.value=(await oe()).data.list??[],V.value=(await ae()).data??[]})();const x=W(),s=H({cate_id:"",goods_id:"",number:"",status:""}),{pagination:L,fetchData:_,dataLoading:T,headerAffixedTop:$,rehandlePageChange:I,lists:N,searchData:O}=re({fetchFun:te,params:s});_();const{query:D}=x.currentRoute.value;Object.keys(D).forEach(t=>{s[t]!==void 0&&(s[t]=Number(D[t]))});const d=h([]),P=t=>{d.value=t},K=h(null),U=async t=>{K.value.init(t)},z=async t=>{const e=v({header:"提醒",body:"是否确认删除？",confirmBtn:"确认",onConfirm:({e:i})=>{e.hide();const{id:n}=t;S({ids:[n]}).then(u=>{u.code===1?(c.success("删除成功"),_()):c.error(`${u.msg}`)}).catch(u=>{c.error("删除失败")})},onClose:({e:i,trigger:n})=>{e.hide()}})},E=X(t=>{const{id:e,is_first:i}=t;ee({id:e,status:i===1?0:1}).then(p=>{p.code===1&&_()})}),F=async()=>{const t=v({header:"提醒",body:"是否确认删除？",confirmBtn:"确认",onConfirm:({e})=>{t.hide();const i={ids:d.value};S(i).then(n=>{n.code===1?(_(),c.success("删除成功"),d.value=[]):c.error(`删除失败：${n.msg}`)}).catch(n=>{c.error("删除失败")})},onClose:({e,trigger:i})=>{t.hide()}})},G=async()=>{const t=v({header:"提醒",body:"确定要清空卡密库存吗？",confirmBtn:"确认",onConfirm:({e})=>{t.hide(),Z().then(i=>{i.code===1?(_(),c.success("清空成功")):c.error(`清空失败：${i.msg}`)}).catch(i=>{c.error("清空失败")})},onClose:({e,trigger:i})=>{t.hide()}})};return(t,e)=>{const i=ce,n=me,p=Y,u=de,M=pe,B=ue,y=fe,j=_e,q=ge;return f(),C(q,{title:"库存列表",class:"basic-container",bordered:!1},{default:o(()=>[R("div",be,[a(u,null,{default:o(()=>[a(i,{modelValue:s.cate_id,"onUpdate:modelValue":e[0]||(e[0]=r=>s.cate_id=r),placeholder:"全部分类",clearable:"",options:g.value},null,8,["modelValue","options"]),a(i,{modelValue:s.goods_id,"onUpdate:modelValue":e[1]||(e[1]=r=>s.goods_id=r),placeholder:"全部商品",clearable:"",options:V.value,keys:{value:"id",label:"name"}},null,8,["modelValue","options"]),a(i,{modelValue:s.status,"onUpdate:modelValue":e[2]||(e[2]=r=>s.status=r),placeholder:"全部状态",clearable:"",options:l(Ce)},null,8,["modelValue","options"]),a(n,{modelValue:s.number,"onUpdate:modelValue":e[3]||(e[3]=r=>s.number=r),placeholder:"请输入关键词",clearable:""},{"suffix-icon":o(()=>[a(l(ne))]),_:1},8,["modelValue"]),a(p,{theme:"primary",onClick:l(O)},{default:o(()=>[m("查询")]),_:1},8,["onClick"])]),_:1})]),a(j,{data:l(N),columns:l(ye),"row-key":"id",pagination:l(L),"selected-row-keys":d.value,loading:l(T),"header-affixed-top":l($),"max-height":"auto","table-layout":"auto",onPageChange:l(I),onSelectChange:P},{topContent:o(()=>[R("div",ve,[a(p,{theme:"primary",onClick:e[4]||(e[4]=r=>l(x).push("/admin/goods/card/add"))},{icon:o(()=>[a(M,{name:"add"})]),default:o(()=>[m(" 添加库存 ")]),_:1}),a(p,{theme:"danger",onClick:G},{default:o(()=>[m(" 全部清空 ")]),_:1}),a(p,{theme:"default",disabled:!d.value.length,onClick:F},{default:o(()=>[m(" 批量删除 ")]),_:1},8,["disabled"]),d.value.length?(f(),b("p",ke,"已选"+J(d.value.length)+"项",1)):Q("",!0)])]),status:o(({row:r})=>[r.status===2?(f(),C(B,{key:0,variant:"light",theme:"success"},{default:o(()=>[m("已售")]),_:1})):(f(),C(B,{key:1,variant:"light",theme:"danger"},{default:o(()=>[m("未售")]),_:1}))]),operation:o(({row:r})=>[a(u,null,{default:o(()=>[a(y,{size:"small",theme:"primary",hover:"color",onClick:w=>l(E)(r)},{default:o(()=>[r.is_first===1?(f(),b("span",Ve," 取消优先 ")):(f(),b("span",xe," 优先销售 "))]),_:2},1032,["onClick"]),a(y,{size:"small",theme:"primary",hover:"color",onClick:w=>U(r)},{default:o(()=>[m("查看")]),_:2},1032,["onClick"]),a(y,{size:"small",theme:"danger",hover:"color",onClick:w=>z(r)},{default:o(()=>[m("删除")]),_:2},1032,["onClick"])]),_:2},1024)]),empty:o(()=>[a(ie,{title:"",tip:"库存为空",type:"list"})]),_:1},8,["data","columns","pagination","selected-row-keys","loading","header-affixed-top","onPageChange"]),a(le,{ref_key:"cardDetailRef",ref:K},null,512)]),_:1})}}}),Bt=he(Ke,[["__scopeId","data-v-16e89a54"]]);export{Bt as default};
