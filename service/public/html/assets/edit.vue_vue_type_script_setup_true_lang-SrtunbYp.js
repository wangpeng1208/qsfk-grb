import{i as d,d as h,e as u,j as M,o as q,c as C,w as i,a as o,u as y,M as g}from"./index-CpJFga7x.js";import{l as F}from"./category-CWa6rpq2.js";import{f as I}from"./date-dYGoxvTx.js";import{T}from"./index-BRf9TXQS.js";import{S as j}from"./index-DePaE_yS.js";import{F as N,a as P}from"./index-jBP3p80B.js";import{I as A}from"./index--0mKpQel.js";import{a as B}from"./index-DN3cI5Ry.js";import{R as E}from"./index-D7oq8DY2.js";import{D as J}from"./index-AQEtrbEO.js";function ie(a){return d.post({url:"/adminapi/article/article/list",params:a})}function L(a){return d.post({url:"/adminapi/article/article/add",params:a})}function G(a){return d.post({url:"/adminapi/article/article/edit",params:a})}function re(a){return d.post({url:"/adminapi/article/article/del",params:a})}const ue=[{colKey:"id",title:"ID"},{colKey:"cate_name",title:"分类"},{colKey:"title",title:"标题"},{colKey:"views",title:"浏览量"},{colKey:"status",title:"状态",cell:(a,{row:n})=>a(T,{variant:"light",theme:n.status===1?"success":"danger"},()=>n.status===1?"正常":"禁用")},{colKey:"top",title:"置顶",cell:(a,{row:n})=>n.top?"是":"否"},{colKey:"create_at",title:"添加时间",cell(a,n){return a("span",I(n.row.create_at))}},{colKey:"operate",title:"操作",fixed:"right"}],z=[{label:"正常",value:1},{label:"禁用",value:0}],H=[{label:"是",value:1},{label:"否",value:0}],Q={name:"EditPopup"},ce=h({...Q,emits:["success"],setup(a,{expose:n,emit:w}){const f=u([]);(async()=>{const{data:s}=await F();f.value=s})();const _={id:0,cate_id:null,title:"",content:"",status:1,top:0,create_at:Date.now(),is_system:0,must_read:0},t=u({..._}),V=(s,e)=>{var m;t.value.create_at=((m=e.dayjsValue)==null?void 0:m.valueOf())||0},c=u(!1),p=u("添加文章");n({init:s=>{const e=JSON.parse(JSON.stringify(s));(e==null?void 0:e.id)>0?(p.value="编辑文章",e.create_at*=1e3,t.value={...e}):(p.value="添加文章",t.value={..._},t.value.create_at=Date.now()),c.value=!0}});const O={cate_id:[{required:!0,message:"必填",type:"error"}],content:[{required:!0,message:"必填",type:"error"}],title:[{required:!0,message:"必填",type:"error"}]},x=w,v=u(),D=async()=>{const s=await v.value.validate();if(typeof s!="object"&&s){const e=t.value.id===0?await L(t.value):await G(t.value);e.code===1?(g.success(e.msg),c.value=!1,x("success")):g.error(e.msg)}};return(s,e)=>{const m=j,r=N,K=A,U=B,k=M("wp-editor"),b=E,S=P,R=J;return q(),C(R,{visible:c.value,"onUpdate:visible":e[6]||(e[6]=l=>c.value=l),"close-on-overlay-click":!1,"destroy-on-close":!0,header:p.value,"on-confirm":D,width:"900px"},{default:i(()=>[o(S,{ref_key:"formRef",ref:v,"label-align":"left",data:t.value,rules:O,"label-width":80},{default:i(()=>[o(r,{label:"文章栏目",name:"cate_id"},{default:i(()=>[o(m,{value:t.value.cate_id,"onUpdate:value":e[0]||(e[0]=l=>t.value.cate_id=l),placeholder:"请选择文章栏目",options:f.value,clearable:"",filterable:""},null,8,["value","options"])]),_:1}),o(r,{label:"文章标题",name:"title"},{default:i(()=>[o(K,{modelValue:t.value.title,"onUpdate:modelValue":e[1]||(e[1]=l=>t.value.title=l),clearable:"",placeholder:"请输入文章标题"},null,8,["modelValue"])]),_:1}),o(r,{label:"添加时间",name:"create_at"},{default:i(()=>[o(U,{modelValue:t.value.create_at,"onUpdate:modelValue":e[2]||(e[2]=l=>t.value.create_at=l),"enable-time-picker":"","allow-input":"",clearable:"",style:{width:"500px"},onChange:V},null,8,["modelValue"])]),_:1}),o(r,{label:"文章内容",name:"content"},{default:i(()=>[o(k,{"model-value":t.value.content,"onUpdate:modelValue":e[3]||(e[3]=l=>t.value.content=l),"user-type":"admin",height:"300px",width:"100%",mode:"simple"},null,8,["model-value"])]),_:1}),o(r,{label:"状态",name:"status"},{default:i(()=>[o(b,{modelValue:t.value.status,"onUpdate:modelValue":e[4]||(e[4]=l=>t.value.status=l),options:y(z)},null,8,["modelValue","options"])]),_:1}),o(r,{label:"置顶",name:"top"},{default:i(()=>[o(b,{modelValue:t.value.top,"onUpdate:modelValue":e[5]||(e[5]=l=>t.value.top=l),options:y(H)},null,8,["modelValue","options"])]),_:1})]),_:1},8,["data"])]),_:1},8,["visible","header"])}}});export{ce as _,ue as c,re as d,ie as l};
