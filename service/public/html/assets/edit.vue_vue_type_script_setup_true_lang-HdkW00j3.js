import{d as T,C as ie,l as N,aa as M,a as s,aE as me,e as E,_ as q,U as Q,as as ye,$ as be,N as ge,O as he,aP as _e,aQ as Ce,a9 as Oe,a5 as Pe,E as Ve,Q as Y,a3 as we,P as Se,L as ke,T as xe,ad as ue,bW as Ie,r as je,o as I,c as j,w as C,u as D,b as Ne,n as B,bX as Re,bY as Be,bZ as Ee,M as Z,B as Fe,b_ as Ke}from"./index-Bbii3Das.js";import Le from"./icon-DNhNAyCh.js";import{R as Ae}from"./index-BdGTSLMf.js";import{F as Me,a as Ue}from"./index-DXOBqNco.js";import{T as De}from"./index-D2-a2ZeP.js";import{I as se}from"./index-CGpzlmyY.js";import{I as Te}from"./index-LB7-EXu2.js";import{P as ze}from"./index-CpVXpLih.js";import{u as We}from"./useCommonClassName-L0zFrjWC.js";import{a as ee,A as te,E as oe}from"./common-CF_MvV9u.js";import{l as ne}from"./log-ZJhmUOBa.js";import{u as $e}from"./useVModel-mAS2bV03.js";import{I as Ge}from"./index-CknG8Rj8.js";import{D as He}from"./index-xCgMvBgb.js";/**
 * tdesign v1.10.1
 * (c) 2024 tdesign
 * @license MIT
 */var Xe={autofocus:Boolean,borderless:Boolean,clearable:Boolean,default:{type:[String,Function]},disabled:Boolean,filter:{type:Function},filterable:{type:Boolean,default:!0},highlightKeyword:{type:Boolean,default:!0},inputProps:{type:Object},options:{type:Array},panelBottomContent:{type:[String,Function]},panelTopContent:{type:[String,Function]},placeholder:{type:String,default:void 0},popupProps:{type:Object},readonly:Boolean,size:{type:String,default:"medium",validator:function(e){return e?["small","medium","large"].includes(e):!0}},status:{type:String,default:"default",validator:function(e){return e?["default","success","warning","error"].includes(e):!0}},textareaProps:{type:Object},tips:{type:[String,Function]},triggerElement:{type:[String,Function]},value:{type:String,default:void 0},modelValue:{type:String,default:void 0},defaultValue:{type:String,default:""},onBlur:Function,onChange:Function,onClear:Function,onCompositionend:Function,onCompositionstart:Function,onEnter:Function,onFocus:Function,onSelect:Function};/**
 * tdesign v1.10.1
 * (c) 2024 tdesign
 * @license MIT
 */var qe=me,ce=/[\\^$.*+?()[\]{}|]/g,Je=RegExp(ce.source);function Qe(l){return l=qe(l),l&&Je.test(l)?l.replace(ce,"\\$&"):l}var pe=Qe,de=T({name:"HighlightOption",props:{content:String,keyword:String},setup:function(e){var n=ie(),u=N(function(){var b,V=e.content,y=e.keyword;if(!V)return{list:[]};if(!M(V)||!y)return{list:[V]};var t=new RegExp(pe(y),"i"),w=(b=V.match(t))===null||b===void 0?void 0:b[0];return{list:V.split(w),keyword:w}});return function(){var b=u.value,V=b.list,y=b.keyword;return s("div",{class:"".concat(n.value,"-select-option__highlight-item")},[V.map(function(t,w){return w?[s("b",{class:"".concat(n.value,"-is-highlight"),key:t+y},[y]),t]:t})])}}});/**
 * tdesign v1.10.1
 * (c) 2024 tdesign
 * @license MIT
 */function le(l,e){var n=Object.keys(l);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(l);e&&(u=u.filter(function(b){return Object.getOwnPropertyDescriptor(l,b).enumerable})),n.push.apply(n,u)}return n}function ae(l){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?le(Object(n),!0).forEach(function(u){q(l,u,n[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach(function(u){Object.defineProperty(l,u,Object.getOwnPropertyDescriptor(n,u))})}return l}var Ye=T({name:"AutoCompleteOptionList",props:{sizeClassNames:Object,value:String,size:String,options:Array,popupVisible:Boolean,highlightKeyword:Boolean,filterable:Boolean,filter:Function},emits:["select"],setup:function(e,n){var u=n.emit,b=n.slots,V=n.expose,y=E(""),t=ie(),w=N(function(){return"".concat(t.value,"-select__list")}),A=N(function(){return["".concat(t.value,"-select-option"),q({},e.sizeClassNames[e.size],e.size)]}),O=N(function(){var v=(e.options||[]).map(function(a){var f={};return M(a)?f={text:a,label:a}:(a.text&&!M(a.text)&&ne.warn("AutoComplete","`text` must be a string."),a.text?f=a:M(a.label)?f=ae(ae({},a),{},{text:a.label}):ne.warn("AutoComplete","one of `label` and `text` must be a existed string.")),f});if(e.filter)v=v.filter(function(a){return e.filter(e.value,a)});else if(e.filterable){var g=new RegExp(pe(e.value),"i");v=v.filter(function(a){return g.test(a.text)})}return v}),R=function(g){for(var a=g.target;a&&a.tagName!=="LI";)a=a.parentNode;var f=a.getAttribute("title");y.value=f,u("select",f,{e:g})},k=function(g){if(ee.test(g.code)||ee.test(g.key)){var a,f=O.value.findIndex(function(K){return K.text===y.value}),d=f-1<0?O.value.length-1:f-1;y.value=(a=O.value[d])===null||a===void 0?void 0:a.text}else if(te.test(g.code)||te.test(g.key)){var o,h=O.value.findIndex(function(K){return K.text===y.value}),_=h+1>=O.value.length?0:h+1;y.value=(o=O.value[_])===null||o===void 0?void 0:o.text}else(oe.test(g.code)||oe.test(g.key))&&y.value&&u("select",y.value,{e:g})},F=function(){_e(document,"keydown",k)},S=function(){Ce(document,"keydown",k)};return V({addKeyboardListener:F,removeKeyboardListener:S}),Q(function(){return e.popupVisible},function(){e.popupVisible?F():S()},{immediate:!0}),Q(function(){return e.value},function(){e.value||(y.value="")},{immediate:!0}),ye(function(){S()}),function(){return O.value.length?s("ul",{class:w.value},[O.value.map(function(v){var g=be(A.value);v.text===y.value&&g.push("".concat(t.value,"-select-option--hover"));var a=v.label;if(ge(v.label))a=v.label(he);else if(b.option){var f;a=(f=b.option)===null||f===void 0?void 0:f.call(b,{option:v})}var d=a||v.text;return s("li",{key:v.text,class:g,title:v.text,onClick:R},[M(d)&&e.highlightKeyword?s(de,{content:d,keyword:e.value},null):d])})]):null}}});/**
 * tdesign v1.10.1
 * (c) 2024 tdesign
 * @license MIT
 */function re(l,e){var n=Object.keys(l);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(l);e&&(u=u.filter(function(b){return Object.getOwnPropertyDescriptor(l,b).enumerable})),n.push.apply(n,u)}return n}function P(l){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?re(Object(n),!0).forEach(function(u){q(l,u,n[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach(function(u){Object.defineProperty(l,u,Object.getOwnPropertyDescriptor(n,u))})}return l}function Ze(l){return typeof l=="function"||Object.prototype.toString.call(l)==="[object Object]"&&!we(l)}var et=T({name:"TAutoComplete",props:Xe,setup:function(e,n){var u=n.slots,b=Oe(e),V=b.value,y=b.modelValue,t=$e(V,y,e.defaultValue,e.onChange),w=Pe(t,2),A=w[0],O=w[1],R=Se(),k=ke(),F=We(),S=F.classPrefix,v=F.sizeClassNames,g=Ve("input"),a=g.globalConfig,f=E(),d=E(),o=function(r,p){var i,x=r.getBoundingClientRect().width||r.offsetWidth||r.clientWidth,U=p.getBoundingClientRect().width||p.offsetWidth||p.clientWidth;return P({width:x>=U?"".concat(x,"px"):"auto"},(i=e.popupProps)===null||i===void 0?void 0:i.overlayInnerStyle)},h=N(function(){return["".concat(S.value,"-auto-complete")]}),_=N(function(){var m,r=["".concat(S.value,"-select__dropdown")];return(m=e.popupProps)!==null&&m!==void 0&&m.overlayClassName&&(r=r.concat(e.popupProps.overlayClassName)),r}),K=N(function(){var m,r=["".concat(S.value,"-select__dropdown-inner")];return(m=e.popupProps)!==null&&m!==void 0&&m.overlayInnerClassName&&(r=r.concat(e.popupProps.overlayInnerClassName)),r}),L=function(r,p){O(r,p)},z=N(function(){var m=P({value:A.value,size:e.size},e.inputProps);return m}),W=function(r,p){var i;f.value=!0,(i=e.onFocus)===null||i===void 0||i.call(e,P(P({},p),{},{value:r})),xe(function(){var x;(x=d.value)===null||x===void 0||x.addKeyboardListener()})},$=function(r,p){var i;(i=e.onBlur)===null||i===void 0||i.call(e,P(P({},p),{},{value:r}))},G=function(r,p){var i;(i=e.onCompositionend)===null||i===void 0||i.call(e,P(P({},p),{},{value:r}))},H=function(r,p){var i;(i=e.onCompositionstart)===null||i===void 0||i.call(e,P(P({},p),{},{value:r}))},X=function(r,p){var i;(i=e.onEnter)===null||i===void 0||i.call(e,P(P({},p),{},{value:r}))},c=function(r,p){var i;e.readonly||e.disabled||(f.value=!1,O(r,p),(i=e.onSelect)===null||i===void 0||i.call(e,r,p))},ve=function(r,p){var i=p.trigger;i!=="trigger-element-click"&&(f.value=r)};return function(){var m,r,p=R("default","triggerElement")||s(se,Y({borderless:e.borderless,placeholder:(m=e.placeholder)!==null&&m!==void 0?m:a.value.placeholder,tips:e.tips,status:e.status,readonly:e.readonly,disabled:e.disabled,autofocus:e.autofocus,clearable:e.clearable,onChange:L,onFocus:W,onBlur:$,onClear:e.onClear,onCompositionend:G,onCompositionstart:H,onEnter:X},z.value),u),i=s(Ye,{ref:d,value:A.value,options:e.options,size:e.size,sizeClassNames:v,onSelect:c,popupVisible:f.value,highlightKeyword:e.highlightKeyword,filterable:e.filterable,filter:e.filter},{option:u.option}),x=k("panelTopContent"),U=k("panelBottomContent"),J=x||!((r=e.options)===null||r===void 0)&&r.length||U?s("div",{class:"".concat(S.value,"-autocomplete__panel")},[x,i,U]):null,fe=P(P({},e.popupProps),{},{overlayInnerStyle:o,overlayInnerClassName:K.value,overlayClassName:_.value});return s("div",{class:h.value},[s(ze,Y({visible:f.value,onVisibleChange:ve,trigger:"focus",placement:"bottom-left",hideEmptyPopup:!0,content:J?function(){return J}:null},fe),Ze(p)?p:{default:function(){return[p]}})])}}});/**
 * tdesign v1.10.1
 * (c) 2024 tdesign
 * @license MIT
 */var tt=ue(et);ue(de);const Ot=[{colKey:"title",title:"标题"},{colKey:"icon",title:"图标"},{colKey:"path",title:"路由地址"},{colKey:"perms",title:"权限字符"},{colKey:"orderNo",title:"排序"},{colKey:"hidden",title:"隐藏"},{colKey:"type",title:"类型"},{colKey:"operate",title:"操作"}],ot=[{label:"显示",value:0},{label:"隐藏",value:1}],nt=[{label:"目录",value:"L"},{label:"菜单",value:"M"},{label:"按钮",value:"B"}],lt=[{label:"缓存",value:1},{label:"不缓存",value:0}],at=N(()=>Ie().filter(n=>n.startsWith("admin/")).filter(n=>!n.includes("/components/")).map(n=>({label:n,value:n}))),rt={name:"EditPopup"},Pt=T({...rt,emits:["success"],setup(l,{expose:e,emit:n}){const u=E(),b=()=>{u.value.init(t.icon)},V=d=>{t.icon=d},y={id:0,pid:0,app:"admin",title:"",path:"",icon:"",component:"",type:"M",orderNo:0,hidden:0,redirect:"",perms:"",keep_alive:0},t=je({...y}),w=E([]),A=async()=>{const{data:d}=await Ke({app:"admin"});w.value=d.list},O=E(null),R=E(!1),k=E("添加菜单"),F=(d,o)=>{if(d)k.value="编辑菜单",S(d);else{k.value="添加菜单";for(const h in y)t[h]=y[h];o&&(t.pid=o)}R.value=!0,A()},S=async d=>{const{data:o}=await Re({id:d});for(const h in t)o[h]!=null&&o[h]!==void 0&&(t[h]=o[h])};e({init:F});const v=d=>{t.component=d===0?"Layout":""},g={name:[{required:!0,message:"必填",type:"error"}],title:[{required:!0,message:"必填",type:"error"}]},a=n,f=async()=>{const d=await O.value.validate();if(typeof d!="object"&&d){let o;t.id===0?o=await Be(t):o=await Ee(t),o.code===1?(Z.success(o.msg),R.value=!1,a("success")):Z.error(o.msg)}};return(d,o)=>{const h=Ae,_=Me,K=De,L=se,z=Te,W=Fe,$=tt,G=Ge,H=Ue,X=He;return I(),j(X,{visible:R.value,"onUpdate:visible":o[11]||(o[11]=c=>R.value=c),"close-on-overlay-click":!1,"destroy-on-close":!0,header:k.value,"on-confirm":f},{default:C(()=>[s(H,{ref_key:"formRef",ref:O,"label-align":"left",data:t,rules:g,"label-width":80},{default:C(()=>[s(_,{label:"菜单类型",name:"type"},{default:C(()=>[s(h,{modelValue:t.type,"onUpdate:modelValue":o[0]||(o[0]=c=>t.type=c),options:D(nt)},null,8,["modelValue","options"])]),_:1}),s(_,{label:"父级菜单",name:"pid"},{default:C(()=>[s(K,{modelValue:t.pid,"onUpdate:modelValue":o[1]||(o[1]=c=>t.pid=c),placeholder:"请选择父级菜单",data:w.value,clearable:"",filterable:"",onChange:v},null,8,["modelValue","data"])]),_:1}),s(_,{label:"菜单名称",name:"title"},{default:C(()=>[s(L,{modelValue:t.title,"onUpdate:modelValue":o[2]||(o[2]=c=>t.title=c),clearable:"",placeholder:"请输入菜单名称"},null,8,["modelValue"])]),_:1}),s(Le,{ref_key:"iconSearchRef",ref:u,onSuccess:V},null,512),t.type==="L"||t.type==="M"?(I(),j(_,{key:0,label:"菜单图标",name:"icon"},{default:C(()=>[s(L,{modelValue:t.icon,"onUpdate:modelValue":o[3]||(o[3]=c=>t.icon=c),clearable:"",placeholder:"请选择菜单图标"},{"prefix-icon":C(()=>[s(z,{name:t.icon,style:{marginRight:"8px"}},null,8,["name"])]),_:1},8,["modelValue"]),s(W,{theme:"primary",onClick:b},{default:C(()=>[Ne("选择图标")]),_:1})]),_:1})):B("",!0),t.type==="L"||t.type==="M"?(I(),j(_,{key:1,label:"路由路径",name:"path",help:"访问的路由地址，如：`user`"},{default:C(()=>[s(L,{modelValue:t.path,"onUpdate:modelValue":o[4]||(o[4]=c=>t.path=c),clearable:"",placeholder:"请输入路由路径"},null,8,["modelValue"])]),_:1})):B("",!0),t.type==="M"?(I(),j(_,{key:2,label:"组件路径",name:"component",help:"组件路径，如：`user/setting/index`，默认在`pages`目录下",tips:"此处支持下拉和模糊搜索；外链使用Iframe,跳转路径为外链地址"},{default:C(()=>[s($,{modelValue:t.component,"onUpdate:modelValue":o[5]||(o[5]=c=>t.component=c),options:D(at),clearable:"","highlight-keyword":"",filterable:"",placeholder:"请输入组件地址组件"},null,8,["modelValue","options"])]),_:1})):B("",!0),t.type==="M"||t.type==="B"?(I(),j(_,{key:3,label:"权限字符",name:"perms",help:"将作为server端API验权使用，跟该方法路径一致",tips:"应用+api+路径,例如：adminapi/setting/socialite/list"},{default:C(()=>[s(L,{modelValue:t.perms,"onUpdate:modelValue":o[6]||(o[6]=c=>t.perms=c),clearable:"",placeholder:"请输入权限字符"},null,8,["modelValue"])]),_:1})):B("",!0),t.type!="B"?(I(),j(_,{key:4,label:"菜单排序",name:"sort",help:"数值越小越排前"},{default:C(()=>[s(G,{modelValue:t.orderNo,"onUpdate:modelValue":o[7]||(o[7]=c=>t.orderNo=c),clearable:"",placeholder:"请输入排序",style:{width:"500px"},theme:"column",min:0},null,8,["modelValue"])]),_:1})):B("",!0),t.type==="L"||t.type==="M"?(I(),j(_,{key:5,label:"是否缓存",name:"cache",help:"开启缓存后，页面切换时不会重新加载"},{default:C(()=>[s(h,{modelValue:t.keep_alive,"onUpdate:modelValue":o[8]||(o[8]=c=>t.keep_alive=c),options:D(lt)},null,8,["modelValue","options"])]),_:1})):B("",!0),t.type==="L"||t.type==="M"?(I(),j(_,{key:6,label:"是否隐藏",name:"hidden",help:"选择隐藏则路由将不会出现在侧边栏，但仍然可以访问"},{default:C(()=>[s(h,{modelValue:t.hidden,"onUpdate:modelValue":o[9]||(o[9]=c=>t.hidden=c),options:D(ot)},null,8,["modelValue","options"])]),_:1})):B("",!0),t.type==="L"||t.type==="M"?(I(),j(_,{key:7,label:"跳转路径",name:"redirect",help:"分割菜单的时候用到"},{default:C(()=>[s(L,{modelValue:t.redirect,"onUpdate:modelValue":o[10]||(o[10]=c=>t.redirect=c),clearable:"",placeholder:"顶级栏目需要输入跳转路径"},null,8,["modelValue"])]),_:1})):B("",!0)]),_:1},8,["data"])]),_:1},8,["visible","header"])}}});export{Pt as _,Ot as c};
