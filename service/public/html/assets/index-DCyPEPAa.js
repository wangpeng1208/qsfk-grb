import{d as Te,C as je,E as Fe,a8 as De,e as O,a9 as Be,a5 as z,U as q,l as d,N as H,ar as Ae,W as y,Y as s,v as ze,a as p,h as Z,ai as ee,Q as ae,_ as x,L as $e,a6 as Re,$ as Ee,ad as Me}from"./index-Dys89YLq.js";import{_ as j,r as b}from"./dep-86139c71-BioGcMu7.js";import{i as Le}from"./dep-40320ba3-B1Ayvxeb.js";import{T as We}from"./index-fX6DPIvv.js";import{S as Je,F as Ke}from"./index-BA1slVbh.js";import{u as Xe}from"./useVModel-ChUVkX5D.js";import{u as le}from"./useDefaultValue-pk1y0m3m.js";/**
 * tdesign v1.10.1
 * (c) 2024 tdesign
 * @license MIT
 */var Ge={autoWidth:Boolean,borderless:Boolean,clearable:Boolean,collapsedItems:{type:Function},data:{type:Array,default:function(){return[]}},disabled:{type:Boolean,default:void 0},empty:{type:[String,Function],default:""},filter:{type:Function},filterable:Boolean,inputProps:{type:Object},inputValue:{type:[String,Number],default:void 0},defaultInputValue:{type:[String,Number]},keys:{type:Object},loading:Boolean,loadingText:{type:[String,Function],default:""},max:{type:Number,default:0},minCollapsedNum:{type:Number,default:0},multiple:Boolean,placeholder:{type:String,default:void 0},popupProps:{type:Object},popupVisible:{type:Boolean,default:void 0},prefixIcon:{type:Function},readonly:Boolean,selectInputProps:{type:Object},size:{type:String,default:"medium",validator:function(e){return e?["small","medium","large"].includes(e):!0}},suffix:{type:[String,Function]},suffixIcon:{type:Function},tagProps:{type:Object},treeProps:{type:Object},value:{type:[String,Number,Object,Array],default:void 0},modelValue:{type:[String,Number,Object,Array],default:void 0},defaultValue:{type:[String,Number,Object,Array]},valueDisplay:{type:Function},valueType:{type:String,default:"value",validator:function(e){return e?["value","object"].includes(e):!0}},onBlur:Function,onChange:Function,onClear:Function,onFocus:Function,onInputChange:Function,onPopupVisibleChange:Function,onRemove:Function,onSearch:Function};/**
 * tdesign v1.10.1
 * (c) 2024 tdesign
 * @license MIT
 */function ue(o,e){var v=Object.keys(o);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(o);e&&(i=i.filter(function(F){return Object.getOwnPropertyDescriptor(o,F).enumerable})),v.push.apply(v,i)}return v}function m(o){for(var e=1;e<arguments.length;e++){var v=arguments[e]!=null?arguments[e]:{};e%2?ue(Object(v),!0).forEach(function(i){x(o,i,v[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(v)):ue(Object(v)).forEach(function(i){Object.defineProperty(o,i,Object.getOwnPropertyDescriptor(v,i))})}return o}var Qe=Te({name:"TTreeSelect",props:Ge,setup:function(e,v){var i=v.slots,F=v.expose,N=$e(),$=Re(),f=je(),ne=Fe("treeSelect"),D=ne.globalConfig,te=De(),h=O(null),V=O([]),R=O([]),c=O(null),E=O(0),T=Be(e),re=T.value,ie=T.modelValue,oe=T.popupVisible,ve=T.inputValue,ce=Xe(re,ie,e.defaultValue,e.onChange),M=z(ce,2),t=M[0],de=M[1],fe=le(oe,!1,e.onPopupVisibleChange,"popupVisible"),L=z(fe,2),C=L[0],W=L[1],se=le(ve,e.defaultInputValue,e.onInputChange,"inputValue"),J=z(se,2),K=J[0],X=J[1];q(t,j(b.mark(function u(){return b.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,k();case 2:e.multiple||(V.value=c.value?[c.value.value]:[]);case 3:case"end":return a.stop()}},u)}))),q(function(){return e.data},j(b.mark(function u(){return b.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,k();case 2:we();case 3:case"end":return a.stop()}},u)})),{deep:!0});var G=d(function(){var u=K.value||"";return u===""?null:function(n){if(H(e.filter)){var a=e.filter(String(u),n);if(Ae(a))return a}return n.data[_.value].indexOf(u)>=0}}),B=d(function(){return te.value||e.disabled}),me=d(function(){var u;return C.value&&((u=c.value)===null||u===void 0?void 0:u.label)||e.placeholder||D.value.placeholder}),ge=d(function(){return["".concat(f.value,"-select__dropdown"),"narrow-scrollbar"]}),be=d(function(){return{small:"s",medium:"m",large:"l"}[e.size]}),I=d(function(){return e.valueType==="object"}),ye=d(function(){return e.multiple?I.value?y(t.value)?t.value.map(function(u){return u.value}):[]:y(t.value)?t.value.map(function(u){return u}):[]:[]}),pe=d(function(){return e.multiple&&!!e.max&&y(t.value)&&e.max<=t.value.length}),_=d(function(){var u;return!s(e.treeProps)&&!s(e.treeProps.keys)?e.treeProps.keys.label||"label":((u=e.keys)===null||u===void 0?void 0:u.label)||"label"}),P=d(function(){var u;return!s(e.treeProps)&&!s(e.treeProps.keys)?e.treeProps.keys.value||"value":((u=e.keys)===null||u===void 0?void 0:u.value)||"value"}),Q=d(function(){var u;return!s(e.treeProps)&&!s(e.treeProps.keys)?e.treeProps.keys.children||"children":((u=e.keys)===null||u===void 0?void 0:u.children)||"children"});ze(j(b.mark(function u(){return b.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!(!t.value&&e.defaultValue)){a.next=3;break}return a.next=3,S(e.defaultValue,null,"uncheck");case 3:I.value?V.value=y(t.value)?t.value.map(function(l){return l.value}):[t.value.value]:V.value=y(t.value)?t.value:[t.value],k();case 5:case"end":return a.stop()}},u)})));var S=function(n,a,l){de(n,{node:a,trigger:l}),k()},he=function(n){var a,l=e.multiple?[]:"";V.value=[],S(l,null,"clear"),(a=e.onClear)===null||a===void 0||a.call(e,{e:n.e})},Ve=function(n,a){var l=n;I.value&&(l=n.map(function(r){return w(e.data,r)})),S(l,a.node,"check")},Ce=function(n,a){if(e.multiple||W(!1,a),!e.multiple&&t.value!==a.node.data[P.value]){var l=n;if(I.value){var r=s(n)?"":n[0];l=w(e.data,r)}else l=s(n)?"":n[0];S(l,a.node,"check"),V.value=n}},Ie=function(n){R.value=n},Pe=function(){k()},Ne=function(n){var a;if(!C.value){var l;(l=e.onSearch)===null||l===void 0||l.call(e,String(n));return}X(n),(a=e.onSearch)===null||a===void 0||a.call(e,String(n))},U=function(n,a){var l,r=a.trigger,g=a.index;["tag-remove","backspace"].includes(r)&&y(t.value)&&t.value.splice(g,1),(l=e.onRemove)===null||l===void 0||l.call(e,{value:n,data:null,e:a&&a.e}),S(t.value,null,r)},_e=function(n,a){W(n,a),n&&a.trigger==="trigger-element-click"&&X("")},k=function(){var u=j(b.mark(function n(){return b.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,t.value;case 2:e.multiple?e.multiple?y(t.value)?c.value=ke():c.value=[]:c.value=null:t.value||t.value===0?c.value=Se():c.value="";case 3:case"end":return l.stop()}},n)}));return function(){return u.apply(this,arguments)}}(),Se=function(){var n,a=I.value?t.value.value:t.value;if(h.value&&(n=e.treeProps)!==null&&n!==void 0&&n.load){if(!s(e.data)){var l=h.value.getItem(a);if(l)return m(m({},l.data),{},{label:l.data[_.value],value:l.data[P.value]})}return{label:a,value:a}}var r=w(e.data,a);return r||{label:a,value:a}},ke=function(){return t.value.map(function(n){var a,l=I.value?n.value:n;if(h.value&&(a=e.treeProps)!==null&&a!==void 0&&a.load){if(!s(e.data)){var r=h.value.getItem(l);if(r)return m(m({},r.data),{},{label:r.data[_.value],value:r.data[P.value]})}return{label:l,value:l}}var g=w(e.data,l);return g||{label:l,value:l}})},w=function(n,a){for(var l=0,r=n.length;l<r;l++){var g;if(n[l][P.value]===a)return m(m({},n[l]),{},{label:n[l][_.value],value:n[l][P.value]});if((g=n[l])!==null&&g!==void 0&&g[Q.value]){var A,Y=w((A=n[l])===null||A===void 0?void 0:A[Q.value],a);if(!Le(Y))return Y}}return null},we=function(){E.value+=1},Oe=function(){return Z(p(We,ae({ref:h,key:E.value,value:Ee(ye.value),hover:!0,keys:e.keys,data:e.data,activable:!e.multiple,checkable:e.multiple,disabled:B.value||pe.value,size:e.size,filter:G.value,icon:!G.value,actived:V.value,expanded:R.value,activeMultiple:e.multiple,onChange:Ve,onActive:Ce,onExpand:Ie,onLoad:Pe,expandOnClickNode:!0},e.treeProps),{empty:function(){return $("empty",{defaultNode:p("div",{class:"".concat(f.value,"-select__empty")},[D.value.empty])})}}),[[ee,!e.loading]])},xe=function(){return p(Ke,{isActive:C.value,disabled:e.disabled,overlayClassName:x(x({},"".concat(f.value,"-fake-arrow--highlight"),C.value),"".concat(f.value,"-fake-arrow--disable"),e.disabled)},null)};return F({treeRef:h}),function(){return p(Je,ae({class:"".concat(f.value,"-tree-select"),value:c.value,inputValue:C.value?K.value:"",popupVisible:C.value,disabled:B.value,multiple:e.multiple,loading:e.loading,clearable:e.clearable,autoWidth:e.autoWidth,borderless:e.borderless,readonly:e.readonly,placeholder:me.value,allowInput:e.filterable||H(e.filter),minCollapsedNum:e.minCollapsedNum,"collapsed-items":e.collapsedItems,popupProps:m({overlayClassName:ge.value},e.popupProps),inputProps:m({size:e.size},e.inputProps),tagInputProps:{size:e.size},tagProps:m({maxWidth:300},e.tagProps),label:function(){return N("prefixIcon")},suffix:e.suffix,suffixIcon:function(){return e.suffixIcon||i.suffixIcon?N("suffixIcon"):xe()},onClear:he,onBlur:function(n,a){var l;(l=e.onBlur)===null||l===void 0||l.call(e,{value:t.value,e:a.e})},onFocus:function(n,a){var l;(l=e.onFocus)===null||l===void 0||l.call(e,{value:t.value,e:a.e})},valueDisplay:function(){return N("valueDisplay",{params:e.multiple?{value:c.value,onClose:function(a){var l=c.value.map(function(r){return r.value});U(l,{trigger:"tag-remove",index:a,item:l[a]})}}:{value:c.value||x(x({},_.value,""),P.value,void 0)}})},onInputChange:Ne,onTagChange:U,onPopupVisibleChange:_e},e.selectInputProps),{suffix:i.suffix,panel:function(){return p("div",{class:["".concat(f.value,"-select__dropdown-inner"),"".concat(f.value,"-select__dropdown-inner--size-").concat(be.value)]},[N("panelTopContent"),Z(p("p",{class:["".concat(f.value,"-select-loading-tips"),"".concat(f.value,"-select__right-icon-polyfill")]},[$("loadingText",{defaultNode:p("div",{class:"".concat(f.value,"-select__empty")},[D.value.loadingText])})]),[[ee,e.loading&&!B.value]]),Oe(),N("panelBottomContent")])},collapsedItems:i.collapsedItems})}}});/**
 * tdesign v1.10.1
 * (c) 2024 tdesign
 * @license MIT
 */var la=Me(Qe);export{la as T};
