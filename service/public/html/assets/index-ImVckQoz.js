import{i as v,d as k,e as l,k as D,l as K,f as P,o as u,c as f,w as h,g as d,a as _,h as T,b as z,p as N,t as R,n as V,u as I,D as M,M as g,B as $}from"./index-Dys89YLq.js";import{p as q}from"./global-DaymibWd.js";import{_ as A}from"./search.vue_vue_type_script_setup_true_lang-BknTILDE.js";import{T as E}from"./index-DbnGGVSd.js";import{C as F}from"./index-D8Ix0oeU.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./search-RV2LQLXF.js";import"./index-Bqwwrko2.js";import"./index-k_yBcVp0.js";import"./useReadonly-GuO_-cT8.js";import"./useVModel-ChUVkX5D.js";import"./log-ZJhmUOBa.js";import"./useResizeObserver-D_uTF440.js";import"./dep-d524834c-s9Vwwbzr.js";import"./close-circle-filled-6NKz9kYY.js";import"./index-BYoZ1jRX.js";import"./dep-86139c71-BioGcMu7.js";import"./form-model-CIY_RhMw.js";import"./dep-4cc4ef27--AW_KZeX.js";import"./dep-40320ba3-B1Ayvxeb.js";import"./index-ZphBY69t.js";import"./dep-96cefb8b-CiB99TH1.js";import"./index-BA1slVbh.js";import"./index-CjM8dnKg.js";import"./dep-02de0cb4-_xWusXWA.js";import"./useDefaultValue-pk1y0m3m.js";import"./index-BcNem8rV.js";import"./common-CF_MvV9u.js";import"./index-Dka09D2p.js";import"./index-xCa1PnD5.js";import"./useCommonClassName-BZA0SnO7.js";import"./number-B3LVzGws.js";import"./index-Ci-WgI1t.js";import"./index-BTVA41u8.js";import"./observe-CfjnoQGd.js";import"./slot-DKAjzcwC.js";import"./chevron-left-Ca8qIpvl.js";import"./chevron-right-Bz__VYX8.js";import"./index-DwGXmo2C.js";import"./index-BT8Ia4HF.js";import"./dep-eedf0c29-ErImML_u.js";import"./useVirtualScrollNew-B7BxRQci.js";import"./dep-af55fe23-hzblXEZ8.js";import"./index-Q2T2ZnL7.js";import"./helper-DDcUnKCP.js";import"./dep-1858b432-DPK9DfHI.js";function j(o){return v.post({url:"/adminapi/permission/log/list",params:o})}function G(o){return v.post({url:"/adminapi/permission/log/delBatch",params:o})}const H=[{colKey:"id",type:"multiple"},{colKey:"username",title:"用户名"},{colKey:"action",title:"访问链接",ellipsis:!0},{colKey:"params",title:"请求参数",ellipsis:!0},{colKey:"title",title:"标题",ellipsis:!0,cell(o,e){const i=e.row.content.split(", 结果：");return o("span",i[0])}},{colKey:"result",title:"结果",ellipsis:!0,cell(o,e){const i=e.row.content.split(", 结果：");return o("span",i[1])}},{colKey:"ip",title:"IP"},{colKey:"create_at",title:"日志时间",width:"160px"}],J={class:"category-header c-flex"},L={class:"category-header c-flex"},O={class:"l"},Q={key:0,class:"selected-count"},W=k({__name:"index",setup(o){const e=l([]),i=t=>{e.value=t},y=async()=>{const t=M({header:"提醒",body:"是否确认删除？",confirmBtn:"确认",onConfirm:()=>{t.hide();const s={ids:e.value};G(s).then(r=>{r.code===1?(n(),g.success(r.msg),e.value=[]):g.error(r.msg)})},onClose:()=>{t.hide()}})},a=l({defaultPageSize:20,total:0,defaultCurrent:1}),c=l([]),p=l(!1),m=l(),n=async(t={})=>{m.value={...t},p.value=!0;const{data:s}=await j({page:a.value.defaultCurrent,limit:a.value.defaultPageSize,...m.value});c.value=s.list,a.value.total=s.total,p.value=!1};n();const x=t=>{a.value.defaultCurrent=t.current,a.value.defaultPageSize=t.pageSize,n(m.value)},C=D(),b=K(()=>({offsetTop:C.isUseTabsRouter?48:0,container:`.${q}-layout`}));return(t,s)=>{const r=$,w=E,B=F,S=P("perms");return u(),f(B,{title:"后台操作日志",class:"basic-container",bordered:!1},{default:h(()=>[d("div",J,[_(A,{ref:"searchFormRef",onSuccess:n},null,512)]),d("div",L,[d("div",O,[T((u(),f(r,{theme:"default",disabled:!e.value.length,onClick:y},{default:h(()=>[z(" 批量删除 ")]),_:1},8,["disabled"])),[[S,["adminapi/permission/log/delBatch"]]]),e.value.length?(u(),N("p",Q,"已选"+R(e.value.length)+"项",1)):V("",!0)])]),_(w,{ref:"tableRef","row-key":"id",data:c.value,columns:I(H),hover:c.value.length>0,"header-affixed-top":b.value,pagination:a.value,"lazy-load":"","max-height":"100%","selected-row-keys":e.value,onPageChange:x,onSelectChange:i,loading:p.value},null,8,["data","columns","hover","header-affixed-top","pagination","selected-row-keys","loading"])]),_:1})}}}),je=U(W,[["__scopeId","data-v-44583a82"]]);export{je as default};
