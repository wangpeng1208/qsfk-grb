import{bz as V,b2 as U,b6 as $,aE as q,bD as O,ar as R,ac as z,aq as g,bE as I,_ as h,X as M,$ as K,N as m,aa as w,bR as G,W,ba as X}from"./index-Dys89YLq.js";import{_ as H}from"./dep-eedf0c29-ErImML_u.js";import{_ as J,r as D}from"./dep-86139c71-BioGcMu7.js";import{i as Q}from"./dep-6f8c2110-CYZdOZC2.js";import{i as Y}from"./dep-40320ba3-B1Ayvxeb.js";import{i as Z}from"./dep-d524834c-s9Vwwbzr.js";import{l as P}from"./log-ZJhmUOBa.js";/**
 * tdesign v1.10.1
 * (c) 2024 tdesign
 * @license MIT
 */var ee=H,te=V,ie=U,F=$,ae=ie(function(d,a){return F(d)?ee(d,te(a,1,F,!0)):[]}),_=ae;function re(d){return{all:d=d||new Map,on:function(a,e){var t=d.get(a);t?t.push(e):d.set(a,[e])},off:function(a,e){var t=d.get(a);t&&(e?t.splice(t.indexOf(e)>>>0,1):d.set(a,[]))},emit:function(a,e){var t=d.get(a);t&&t.slice().map(function(i){i(e)}),(t=d.get("*"))&&t.slice().map(function(i){i(a,e)})}}}/**
 * tdesign v1.10.1
 * (c) 2024 tdesign
 * @license MIT
 */var ne=q,se=0;function le(d){var a=++se;return ne(d)+a}var de=le;/**
 * tdesign v1.10.1
 * (c) 2024 tdesign
 * @license MIT
 */var c="__tdesign_tree-node__",ue=function(){function d(a){I(this,d),h(this,c,void 0),this[c]=a}return O(d,[{key:"value",get:function(){var e=this[c];return e.value}},{key:"label",get:function(){var e=this[c];return e.label}},{key:"data",get:function(){var e=this[c];return e.data}},{key:"actived",get:function(){var e=this[c];return e.actived}},{key:"expanded",get:function(){var e=this[c];return e.expanded}},{key:"checked",get:function(){var e=this[c];return e.checked}},{key:"indeterminate",get:function(){var e=this[c];return e.indeterminate}},{key:"loading",get:function(){var e=this[c];return e.loading}},{key:"disabled",get:function(){var e=this[c];return e.isDisabled()}},{key:"getLevel",value:function(){var e=this[c];return e.getLevel()}},{key:"getIndex",value:function(){var e=this[c];return e.getIndex()}},{key:"isFirst",value:function(){var e=this[c];return e.isFirst()}},{key:"isLast",value:function(){var e=this[c];return e.isLast()}},{key:"isLeaf",value:function(){var e=this[c];return e.isLeaf()}},{key:"insertBefore",value:function(e){var t=this[c];return t.insertBefore(e)}},{key:"insertAfter",value:function(e){var t=this[c];return t.insertAfter(e)}},{key:"appendData",value:function(e){var t=this[c];return t.append(e)}},{key:"getPath",value:function(){var e=this[c],t=e.getPath();return t.map(function(i){return i.getModel()})}},{key:"getParent",value:function(){var e,t=this[c];return(e=t.parent)===null||e===void 0?void 0:e.getModel()}},{key:"getParents",value:function(){var e=this[c],t=e.getParents();return t.map(function(i){return i.getModel()})}},{key:"getRoot",value:function(){var e=this[c],t=e.getRoot();return t==null?void 0:t.getModel()}},{key:"getSiblings",value:function(){var e=this[c],t=e.getSiblings();return t.map(function(i){return i.getModel()})}},{key:"getChildren",value:function(e){var t=this[c],i=!1,n=t.children;if(Array.isArray(n))if(n.length>0)if(e){var r=t.walk();r.shift(),i=r.map(function(s){return s.getModel()})}else i=n.map(function(s){return s.getModel()});else i=!1;else R(n)&&(i=n);return i}},{key:"remove",value:function(e){var t=this[c];if(!e){t.remove();return}var i=t.tree,n=i.getNode(e);if(!n){P.warnOnce("Tree","`".concat(e,"` is not exist"));return}var r=n.getParents(),s=r.map(function(l){return l.value});if(s.indexOf(t.value)<0){P.warnOnce("Tree","`".concat(e,"` is not a childNode of current node"));return}n.remove()}},{key:"setData",value:function(e){var t=this[c],i=["value","label","disabled"],n=z(e,["children"].concat(i)),r=t.tree.config.keys;i.forEach(function(s){var l=g(e,(r==null?void 0:r[s])||s);Z(l)||(n[s]=l)}),Object.assign(t.data,n),Object.assign(t,n),t.update()}}])}();function he(d){var a=new ue(d);return a}/**
 * tdesign v1.10.1
 * (c) 2024 tdesign
 * @license MIT
 */function L(d,a){var e=Object.keys(d);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(d);a&&(t=t.filter(function(i){return Object.getOwnPropertyDescriptor(d,i).enumerable})),e.push.apply(e,t)}return e}function E(d){for(var a=1;a<arguments.length;a++){var e=arguments[a]!=null?arguments[a]:{};a%2?L(Object(e),!0).forEach(function(t){h(d,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(e)):L(Object(e)).forEach(function(t){Object.defineProperty(d,t,Object.getOwnPropertyDescriptor(e,t))})}return d}var oe=Object.prototype.hasOwnProperty,j={expandMutex:null,activable:null,checkable:null,draggable:null,loading:!1},ce=Object.keys(j),ve=[].concat(ce,["actived","expanded","checked"]),b="__tdesign_id__",x=function(){function d(a,e,t){var i=this;I(this,d),h(this,"tree",void 0),h(this,b,void 0),h(this,"value",void 0),h(this,"label",void 0),h(this,"data",void 0),h(this,"parent",void 0),h(this,"children",void 0),h(this,"model",void 0),h(this,"vmIsLeaf",void 0),h(this,"vmIsFirst",void 0),h(this,"vmIsLast",void 0),h(this,"vmIsRest",void 0),h(this,"vmIsLocked",void 0),h(this,"expanded",void 0),h(this,"expandMutex",void 0),h(this,"actived",void 0),h(this,"activable",void 0),h(this,"checkable",void 0),h(this,"vmCheckable",void 0),h(this,"checked",void 0),h(this,"indeterminate",void 0),h(this,"disabled",void 0),h(this,"draggable",void 0),h(this,"visible",void 0),h(this,"level",void 0),h(this,"loading",void 0),this.data=e,this.tree=a;var n=a.config||{},r=n.prefix||"t",s=n.keys||{},l=s.children||"children",u=s.label||"label",o=s.value||"value",v=s.disabled||"disabled";this.model=null,this.children=null,this.level=0,this.vmCheckable=!1,this.vmIsLeaf=!1,this.vmIsFirst=!1,this.vmIsLast=!1,this.vmIsRest=!1,this.vmIsLocked=!1,this.visible=!1,this.actived=!1,this.checked=!1,this.indeterminate=!1,this.loading=!1,this.expanded=n.expandAll,this.activable=null,this.checkable=null,this.expandMutex=null,this.draggable=null,this[b]=de(r),this.value=Y(g(e,o))?this[b]:g(e,o);var f=a.nodeMap,p=a.privateMap;f.get(this.value)&&P.warn("Tree","Dulplicate value: ".concat(this.value)),f.set(this.value,this),p.set(this[b],this),this.label=g(e,u)||"",this.disabled=g(e,v)||!1;var k=e[l];k===!0&&(this.children=k),t&&t instanceof d?this.parent=t:this.parent=null,ve.forEach(function(A){typeof e[A]<"u"&&(i[A]=e[A])}),this.initActived(),this.initExpanded(),Array.isArray(k)?this.append(k):k===!0&&!n.lazy&&this.loadChildren(),this.initChecked(),this.updateChecked(),this.update(),a.reflow(this)}return O(d,[{key:"initChecked",value:function(){var e=this.tree,t=this.value,i=this.parent,n=e.checkedMap,r=e.config.checkStrictly;this.checked&&n.set(t,!0),!r&&i!==null&&i!==void 0&&i.checked&&n.set(t,!0)}},{key:"initExpanded",value:function(){var e=this.tree,t=this.expanded,i=e.config;M(i.expandLevel)&&this.getLevel()<i.expandLevel&&(e.expandedMap.set(this.value,!0),t=!0),this.children===!0&&i.lazy&&(t=!1),t?e.expandedMap.set(this.value,!0):e.expandedMap.delete(this.value),this.expanded=t}},{key:"initActived",value:function(){var e=this.tree,t=this.actived;t&&this.isActivable()&&e.activedMap.set(this.value,!0)}},{key:"append",value:function(e){var t=this,i=[];if(Array.isArray(e)?i.push.apply(i,K(e)):i.push(e),!(i.length<=0)){Array.isArray(this.children)||(this.children=[]);var n=this.children,r=this.tree;i.forEach(function(s){var l=null;s instanceof d?(l=s,l.appendTo(t.tree,t)):(l=new d(t.tree,s,t),n.push(l))}),r.reflow(this),this.updateRelated()}}},{key:"appendTo",value:function(e,t,i){var n=this,r=t,s=-1;M(i)&&(s=i);var l=(r==null?void 0:r.getParents())||[],u=l.some(function(y){return y===n});if(u)throw new Error("无法将父节点插入到子节点");if(r===this)throw new Error("无法将节点插入到本节点");if(Array.isArray(r==null?void 0:r.children)){var o=r==null?void 0:r.children[s];if(o&&o===this)return}var v=null;if(r instanceof d?(Array.isArray(r==null?void 0:r.children)||(r.children=[]),v=t.children):v=e.children,!Array.isArray(v))throw new Error("无法插入到目标位置，可插入的节点列表不存在");var f=v.length,p=this.getIndex();if(this.remove(),M(i)){var k=i;if(r===this.parent){var A=v.length;A<f&&p<=k&&(k-=1)}v.splice(k,0,this)}else v.push(this);this.parent=r;var T=this.walk();T.forEach(function(y){var C=y;C.tree=e,e.nodeMap.set(C.value,C),e.privateMap.set(C[b],C),C.expanded&&e.expandedMap.set(C.value,!0)});var B=(r==null?void 0:r.walk())||e.children.map(function(y){return y.walk()}).flat();B.forEach(function(y){y.update(),y.updateChecked()}),e.reflow()}},{key:"insert",value:function(e,t){var i=this.tree,n=this.parent,r=this.getSiblings(),s=null;e instanceof d?(s=e,s.appendTo(i,n,t)):e&&(s=new d(i,e,n),M(t)&&r.splice(t,0,s),r.forEach(function(l){l.update()})),i.reflow()}},{key:"insertBefore",value:function(e){var t=this.getIndex();this.insert(e,t)}},{key:"insertAfter",value:function(e){var t=this.getIndex();this.insert(e,t+1)}},{key:"remove",value:function(){var e=this.tree,t=this.walk(),i=this.getSiblings(),n=this.getIndex();Array.isArray(i)&&i.splice(n,1),t.forEach(function(r){r.clean()}),i.forEach(function(r){r.update()}),this.updateParents(),e.reflow()}},{key:"clean",value:function(){var e=this.tree,t=this.value;e.activedMap.delete(t),e.checkedMap.delete(t),e.expandedMap.delete(t),e.nodeMap.delete(t),e.filterMap.delete(t),e.privateMap.delete(this[b])}},{key:"loadChildren",value:function(){var a=J(D.mark(function t(){var i,n;return D.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(i=g(this,"tree.config")||{},!(this.children===!0&&!this.loading)){s.next=13;break}if(!m(i.load)){s.next=13;break}return this.loading=!0,this.update(),n=[],s.next=8,i.load(this);case 8:n=s.sent,this.tree.emit("load",{node:this,data:n}),this.loading=!1,Array.isArray(n)&&n.length>0?this.append(n):this.children=!1,this.update();case 13:case"end":return s.stop()}},t,this)}));function e(){return a.apply(this,arguments)}return e}()},{key:"set",value:function(e){var t=this,i=this.tree,n=Object.keys(e);n.forEach(function(r){(oe.call(j,r)||r==="label")&&(t[r]=e[r]),r==="disabled"&&t.setDisabled(e[r])}),i.updated(this)}},{key:"getParent",value:function(){return this.parent}},{key:"getParents",value:function(){for(var e=[],t=this.parent;t;)e.push(t),t=t.parent;return e}},{key:"getSiblings",value:function(){var e=this.parent,t=this.tree,i=[];return e?Array.isArray(e.children)&&(i=e.children):t&&(i=t.children),i}},{key:"getChildren",value:function(e){var t=!1,i=this.children;if(Array.isArray(i))if(i.length>0)if(e){var n=this.walk();n.shift(),t=n.map(function(r){return r.getModel()})}else t=i.map(function(r){return r.getModel()});else t=!1;else R(i)&&(t=i);return t}},{key:"getRoot",value:function(){var e=this.getParents();return e[e.length-1]||null}},{key:"getIndex",value:function(){var e=this.getSiblings();return e.indexOf(this)}},{key:"getPath",value:function(){var e=this.getParents();return e.unshift(this),e.reverse()}},{key:"getLevel",value:function(){var e=this.getParents();return e.length}},{key:"isRest",value:function(){var e=this.tree,t=e.config,i=e.filterMap,n=e.hasFilter,r=!1;if(n){var s=this.getModel();r=t.filter(s)}return r?i.set(this.value,!0):i.get(this.value)&&i.delete(this.value),r}},{key:"isVisible",value:function(){var e=this.tree,t=e.nodeMap,i=e.hasFilter,n=e.config,r=n.allowFoldNodeOnFilter,s=!0;if(!t.get(this.value))return!1;if(i&&!r)return s=this.vmIsLocked||this.vmIsRest,s;var l=!0,u=this.getParents();return u.length>0&&(l=u.every(function(o){return o.expanded})),i?s=l&&(this.vmIsRest||this.vmIsLocked):s=l,s}},{key:"isDisabledState",value:function(){var e=this.tree,t=this.parent,i=e.config,n=i.disabled,r=i.disableCheck,s=i.checkStrictly,l=n||!1;return this.disabled&&(l=!0),!s&&t!==null&&t!==void 0&&t.isDisabledState()&&(l=!0),typeof r=="boolean"?r&&(l=!0):typeof r=="function"&&r(this.getModel())&&(l=!0),l}},{key:"isDisabled",value:function(){var e=this.tree,t=e.hasFilter,i=e.config,n=i.allowFoldNodeOnFilter;return t&&!n&&this.vmIsLocked&&!this.vmIsRest?!0:this.isDisabledState()}},{key:"isDraggable",value:function(){var e=!!g(this,"tree.config.draggable");return typeof this.draggable=="boolean"&&(e=this.draggable),e}},{key:"isExpandMutex",value:function(){var e=!!g(this,"tree.config.expandMutex");return typeof this.expandMutex=="boolean"&&(e=this.expandMutex),e}},{key:"isActivable",value:function(){var e=!!g(this,"tree.config.activable");return typeof this.activable=="boolean"&&(e=this.activable),e}},{key:"isCheckable",value:function(){var e=!!g(this,"tree.config.checkable");return typeof this.checkable=="boolean"&&(e=this.checkable),e}},{key:"isActived",value:function(e){var t=this.tree,i=this.value,n=e||t.activedMap;return!!(t.nodeMap.get(i)&&n.get(i))}},{key:"isExpanded",value:function(e){var t=this.tree,i=this.value,n=this.vmIsLocked,r=t.hasFilter,s=t.config,l=s.allowFoldNodeOnFilter;if(r&&!l&&n)return!0;var u=e||t.expandedMap;return!!(t.nodeMap.get(i)&&u.get(i))}},{key:"isChecked",value:function(e){var t=this.children,i=this.tree,n=this.value,r=i.config.checkStrictly;if(!i.nodeMap.get(n)||!this.isCheckable())return!1;var s=e||i.checkedMap,l=!1;if(s.get(n))return!0;if(r)return!!s.get(n);if(Array.isArray(t)&&t.length>0)l=t.every(function(o){var v=o.isChecked(s);return v});else{var u=this.getParents();l=u.some(function(o){return s.get(o.value)})}return l}},{key:"isIndeterminate",value:function(){var e=this.children,t=this.tree,i=this.value,n=t.config.checkStrictly;if(!t.nodeMap.get(i)||!this.isCheckable()||n||!Array.isArray(e))return!1;var r=null,s=e.some(function(l){return!!(l.isIndeterminate()||(Q(r)&&(r=l.isChecked()),r!==l.isChecked()))});return s}},{key:"isFirst",value:function(){var e=this.getSiblings();return e[0]===this}},{key:"isLast",value:function(){var e=this.getSiblings();return e[e.length-1]===this}},{key:"isLeaf",value:function(){var e=!1;return Array.isArray(this.children)?e=this.children.length<=0:e=!this.children,e}},{key:"lock",value:function(e){this.vmIsLocked=e,this.expanded=this.isExpanded(),this.visible=this.isVisible()}},{key:"afterExpanded",value:function(){this.update(),this.expanded&&this.children===!0&&this.loadChildren(),this.updateChildren()}},{key:"toggleExpanded",value:function(e){return this.setExpanded(!this.isExpanded(),e)}},{key:"setExpanded",value:function(e,t){var i=this.tree,n=i.config,r=E({directly:!1},t),s=i.expandedMap;if(r.directly||(s=new Map(i.expandedMap)),e){var l=[];l.push(this),n.expandParent&&this.getParents().forEach(function(u){l.push(u)}),l.forEach(function(u){var o=!1;if(u.parent)o=u.parent.isExpandMutex();else{var v;o=i==null||(v=i.config)===null||v===void 0?void 0:v.expandMutex}if(o){var f=u.getSiblings();f.forEach(function(p){s.delete(p.value),p.update(),p.updateChildren()})}s.set(u.value,!0),u.update(),u.updateChildren()})}else s.delete(this.value);return r.directly&&this.afterExpanded(),i.getExpanded(s)}},{key:"toggleActived",value:function(e){return this.setActived(!this.isActived(),e)}},{key:"setActived",value:function(e,t){var i=this.tree,n=E({isAction:!0,directly:!1},t),r=i.config||{},s=i.activedMap;if(n.directly||(s=new Map(i.activedMap)),n.isAction&&this.isDisabledState())return i.getActived(s);if(this.isActivable())if(e){var l=Array.from(s.keys());r.activeMultiple||s.clear(),l.forEach(function(u){var o=i.getNode(u);o==null||o.update()}),s.set(this.value,!0)}else s.delete(this.value);return this.update(),i.getActived(s)}},{key:"hasEnableUnCheckedChild",value:function(){var e=this.children;if(!Array.isArray(e)||e.length<=0)return!1;var t=!1;return e.some(function(i){return i.isDisabledState()||i.isChecked()?!1:i.isIndeterminate()?i.hasEnableUnCheckedChild()?(t=!0,!0):!1:(t=!0,!0)}),t}},{key:"toggleChecked",value:function(e){if(this.isIndeterminate()){var t=this.hasEnableUnCheckedChild();return this.setChecked(t,e)}return this.setChecked(!this.isChecked(),e)}},{key:"setChecked",value:function(e,t){var i=this.tree,n=i.config||{},r=E({isAction:!0,directly:!1},t),s=i.checkedMap;if(r.directly||(s=new Map(i.checkedMap)),!this.isCheckable()||r.isAction&&this.isDisabledState())return i.getChecked(s);if(e===this.isChecked()){var l=this.isIndeterminate()&&!this.hasEnableUnCheckedChild();if(!l)return i.getChecked(s)}if(e?s.set(this.value,!0):s.delete(this.value),n.checkStrictly)r.directly&&this.updateChecked();else if(this.spreadChildrenChecked(e,s,r),this.spreadParentChecked(e,s,r),r.directly){var u=i.getRelatedNodes([this.value],{reverse:!0});u.forEach(function(o){o.updateChecked()})}return i.getChecked(s)}},{key:"spreadParentChecked",value:function(e,t,i){var n=E({isAction:!0,directly:!1},i);if(this.isCheckable()){var r=this.children;Array.isArray(r)&&r.length>0&&t.delete(this.value);var s=this.parent;s&&s.spreadParentChecked(e,t,n)}}},{key:"spreadChildrenChecked",value:function(e,t,i){var n=E({isAction:!0,directly:!1},i);if(this.isCheckable()&&!(n.isAction&&this.isDisabledState())){var r=this.children;Array.isArray(r)&&(r.length<=0||(t.delete(this.value),r.forEach(function(s){n.isAction&&s.isDisabledState()||(e?t.set(s.value,!0):t.delete(s.value),s.spreadChildrenChecked(e,t,n))})))}}},{key:"setDisabled",value:function(e){this.disabled=e,this.update(),this.updateChildren()}},{key:"update",value:function(){this.level=this.getLevel(),this.vmIsFirst=this.isFirst(),this.vmIsLast=this.isLast(),this.vmIsLeaf=this.isLeaf(),this.vmCheckable=this.isCheckable(),this.vmIsRest=this.isRest(),this.actived=this.isActived(),this.expanded=this.isExpanded(),this.visible=this.isVisible(),this.tree.updated(this)}},{key:"updateChecked",value:function(){var e=this.tree,t=this.value,i=e.checkedMap;this.checked=this.isChecked(),this.indeterminate=this.isIndeterminate(),this.checked&&i.set(t,!0),e.updated(this)}},{key:"updateChildren",value:function(){var e=this;this.spreadChildren(function(t){t!==e&&(t.update(),t.updateChecked())})}},{key:"updateParents",value:function(){var e=this;this.spreadParents(function(t){t!==e&&(t.update(),t.updateChecked())})}},{key:"updateRelated",value:function(){var e=this.tree,t=e.getRelatedNodes([this.value]);t.forEach(function(i){i.update(),i.updateChecked()})}},{key:"walk",value:function(){var e=[];return this.spreadChildren(function(t){e.push(t)}),e}},{key:"spreadChildren",value:function(e){e(this);var t=this.children;Array.isArray(t)&&t.length>0&&t.forEach(function(i){i==null||i.spreadChildren(e)})}},{key:"spreadParents",value:function(e){e(this);var t=this.parent;t&&(t==null||t.spreadParents(e))}},{key:"getModel",value:function(){var e=this.model;return e||(e=he(this),this.model=e),e}}])}();/**
 * tdesign v1.10.1
 * (c) 2024 tdesign
 * @license MIT
 */function S(d,a){var e=Object.keys(d);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(d);a&&(t=t.filter(function(i){return Object.getOwnPropertyDescriptor(d,i).enumerable})),e.push.apply(e,t)}return e}function N(d){for(var a=1;a<arguments.length;a++){var e=arguments[a]!=null?arguments[a]:{};a%2?S(Object(e),!0).forEach(function(t){h(d,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(e)):S(Object(e)).forEach(function(t){Object.defineProperty(d,t,Object.getOwnPropertyDescriptor(e,t))})}return d}function fe(d){var a=Promise.resolve();return a.then(d),a}var xe=function(){function d(a){I(this,d),h(this,"children",void 0),h(this,"nodes",void 0),h(this,"nodeMap",void 0),h(this,"privateMap",void 0),h(this,"config",void 0),h(this,"activedMap",void 0),h(this,"updatedMap",void 0),h(this,"checkedMap",void 0),h(this,"expandedMap",void 0),h(this,"filterMap",void 0),h(this,"hasFilter",void 0),h(this,"emitter",void 0),h(this,"updateTick",void 0),h(this,"shouldReflow",void 0),h(this,"prevFilter",void 0);var e=N({prefix:"t",keys:{},expandAll:!1,expandLevel:0,expandMutex:!1,expandParent:!1,activable:!1,activeMultiple:!1,checkable:!1,checkStrictly:!1,disabled:!1,disableCheck:!1,draggable:!1,load:null,lazy:!1,valueMode:"onlyLeaf",filter:null,allowFoldNodeOnFilter:!1,onLoad:null,onReflow:null,onUpdate:null},a);this.config=e,this.nodes=[],this.children=[],this.nodeMap=new Map,this.privateMap=new Map,this.activedMap=new Map,this.expandedMap=new Map,this.checkedMap=new Map,this.updatedMap=new Map,this.filterMap=new Map,this.prevFilter=null,this.updateTick=null,this.shouldReflow=!1,this.hasFilter=m(e.filter),this.emitter=re()}return O(d,[{key:"setConfig",value:function(e){var t=this.config,i=!1;Object.keys(e).forEach(function(n){var r=e[n];r!==t[n]&&(i=!0,t[n]=r)}),this.hasFilter=m(t.filter),i&&this.refreshState()}},{key:"getChildren",value:function(){return this.children}},{key:"getNode",value:function(e){var t=null;return w(e)||M(e)?t=this.nodeMap.get(e):e instanceof x&&(t=this.nodeMap.get(e.value)),t||(t=null),t}},{key:"getIndex",value:function(e){return this.nodes.indexOf(e)}},{key:"getParent",value:function(e){var t=null,i=this.getNode(e);return i&&(t=i.getParent()),t}},{key:"getParents",value:function(e){var t=this.getNode(e),i=[];return t&&(i=t.getParents()),i}},{key:"getNodeIndex",value:function(e){var t=this.getNode(e),i=-1;return t&&(i=t.getIndex()),i}},{key:"getNodes",value:function(e,t){var i=[],n="";if(w(e)||M(e)?n=e:e instanceof x&&(n=e.value),!n)i=this.nodes.slice(0);else{var r=this.getNode(n);r&&(i=r.walk())}if(t){var s=N({filter:null,level:1/0},t);M(s.level)&&s.level!==1/0&&(i=i.filter(function(l){return l.level<=s.level})),m(s.filter)&&(i=i.filter(function(l){var u=l.getModel();return s.filter(u)})),G(s.props)&&(i=i.filter(function(l){var u=Object.keys(s.props).every(function(o){var v=l[o]===s.props[o];return v});return u}))}return i}},{key:"append",value:function(e){var t=this;e.forEach(function(i){var n=new x(t,i);t.children.push(n)}),this.reflow()}},{key:"reload",value:function(e){this.removeAll(),this.append(e)}},{key:"parseNodeData",value:function(e,t){var i="",n=null,r=null;w(e)||M(e)?(i=e,n=this.getNode(i),r=t):e instanceof x&&t?(n=e,r=t):r=e;var s={node:n,data:r};return s}},{key:"appendNodes",value:function(e,t){var i=this.parseNodeData(e,t);i.data&&(i.node?(i.data instanceof x?i.data.appendTo(this,i.node):W(i.data)?i.node.append(i.data):i.node.append([i.data]),i.node.updateRelated()):i.data instanceof x?i.data.appendTo(this):Array.isArray(i.data)?this.append(i.data):this.append([i.data]))}},{key:"insertBefore",value:function(e,t){var i=this.getNode(e);i&&i.insertBefore(t)}},{key:"insertAfter",value:function(e,t){var i=this.getNode(e);i&&i.insertAfter(t)}},{key:"refreshNodes",value:function(){var e=this.children,t=this.nodes;t.length=0,e.forEach(function(i){var n=i.walk();Array.prototype.push.apply(t,n)})}},{key:"reflow",value:function(e){this.shouldReflow=!0,this.updated(e)}},{key:"updated",value:function(e){var t=this,i=this.updatedMap;e?i.set(e[b],"changed"):this.getNodes().forEach(function(n){i.set(n[b],"changed")}),!this.updateTick&&(this.updateTick=fe(function(){t.updateTick=null,t.shouldReflow&&(t.refreshNodes(),t.emit("reflow")),t.lockFilterPathNodes();var n="t".concat(new Date().getTime()),r=Array.from(i.keys()),s=r.map(function(l){return i.set(l,n),t.privateMap.get(l)});t.emit("update",{nodes:s,map:i}),t.shouldReflow=!1,i.clear()}))}},{key:"getActived",value:function(e){var t=e||this.activedMap;return Array.from(t.keys())}},{key:"getActivedNodes",value:function(e){var t=this.getNodes(e);return t=t.filter(function(i){return i.isActived()}),t}},{key:"replaceActived",value:function(e){this.resetActived(),this.setActived(e)}},{key:"setActived",value:function(e){var t=this,i=this.config.activeMultiple,n=e.slice(0);i||(n.length=1),n.forEach(function(r){t.activedMap.set(r,!0);var s=t.getNode(r);s&&s.update()})}},{key:"resetActived",value:function(){var e=this.getActived();this.activedMap.clear();var t=this.getRelatedNodes(e);t.forEach(function(i){i.update()})}},{key:"getExpanded",value:function(e){var t=e||this.expandedMap;return Array.from(t.keys())}},{key:"replaceExpanded",value:function(e){var t=this.getExpanded(),i=_(e,t),n=_(t,e);this.setExpandedDirectly(n,!1),this.updateExpanded(n),this.setExpanded(i)}},{key:"setExpanded",value:function(e){this.setExpandedDirectly(e),this.updateExpanded(e)}},{key:"setExpandedDirectly",value:function(e){var t=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.forEach(function(n){i?t.expandedMap.set(n,!0):t.expandedMap.delete(n);var r=t.getNode(n);r&&r.afterExpanded()})}},{key:"resetExpanded",value:function(){var e=this.getExpanded();this.expandedMap.clear(),this.updateExpanded(e)}},{key:"updateExpanded",value:function(e){var t=this.getRelatedNodes(e,{withParents:!1});t.forEach(function(i){i.update()})}},{key:"getChecked",value:function(e){var t=this.nodeMap,i=this.config,n=i.valueMode,r=i.checkStrictly,s=[],l=e||this.checkedMap;return t.forEach(function(u){u.isChecked(l)&&(n==="parentFirst"&&!r?(!u.parent||!u.parent.isChecked(l))&&s.push(u.value):n==="onlyLeaf"&&!r?u.isLeaf()&&s.push(u.value):s.push(u.value))}),s}},{key:"getCheckedNodes",value:function(e){var t=this.getNodes(e);return t=t.filter(function(i){return i.isChecked()}),t}},{key:"replaceChecked",value:function(e){this.resetChecked(),this.setChecked(e)}},{key:"setChecked",value:function(e){var t=this,i=this.config,n=i.checkStrictly,r=i.checkable;if(r&&(e.forEach(function(u){var o=t.getNode(u);if(o)if(n)t.checkedMap.set(u,!0),o.updateChecked();else{var v=o.walk();v.forEach(function(f){t.checkedMap.set(f.value,!0)})}}),!n)){var s=this.getChecked(),l=this.getRelatedNodes(s);l.forEach(function(u){u.updateChecked()})}}},{key:"resetChecked",value:function(){var e=this.getChecked(),t=this.getRelatedNodes(e);this.checkedMap.clear(),t.forEach(function(i){i.updateChecked()})}},{key:"refreshState",value:function(){var e=this.nodeMap;e.forEach(function(t){t.update()})}},{key:"updateAll",value:function(){var e=this.nodeMap;e.forEach(function(t){t.update(),t.updateChecked()})}},{key:"remove",value:function(e){var t=this.getNode(e);t&&t.remove()}},{key:"removeAll",value:function(){this.expandedMap.clear(),this.checkedMap.clear(),this.activedMap.clear(),this.filterMap.clear(),this.nodeMap.clear(),this.privateMap.clear(),this.updatedMap.clear(),this.nodes=[],this.children=[],this.reflow()}},{key:"getRelatedNodes",value:function(e,t){var i=this,n=N({reverse:!1,withParents:!0},t),r=new Map;e.forEach(function(l){if(!r.get(l)){var u=i.getNode(l);if(u){var o=u.getParents().reverse(),v=u.walk(),f=[];n.withParents?f=o.concat(v):f=v,f.forEach(function(p){r.set(p.value,p)})}}});var s=Array.from(r.values());return n.reverse&&(s=s.reverse()),s}},{key:"emit",value:function(e,t){var i=this.config,n=this.emitter,r=X("on-".concat(e)),s=i[r];m(s)&&s(t),n.emit(e,t)}},{key:"lockFilterPathNodes",value:function(){var e=this.config,t=this.getNodes();this.prevFilter&&t.forEach(function(n){n.vmIsLocked&&n.lock(!1)});var i=e.filter;!i||!m(i)||(this.prevFilter=e.filter,t.reverse().forEach(function(n){var r=n.getParent();r&&(n.vmIsRest||n.vmIsLocked)&&(r.vmIsLocked||r.lock(!0))}))}}])}();export{xe as T,b as p};
