import{d as F,e as S,l as T}from"./role-DDE9h7PK.js";import{d as U,r as h,e as i,o as A,c as I,w as c,a as s,M as u}from"./index-DyfhlEKp.js";import{T as M}from"./index-PGf1iCVp.js";import{F as O,a as q}from"./index-53D3hsao.js";import{I as B}from"./index-DB8QFTGe.js";import{D as C}from"./index-DWHfpBzf.js";const E={name:"AdminEditPopup"},J=U({...E,emits:["success"],setup(P,{expose:_,emit:v}){const m={pid:"",name:"",id:""},t=h({...m}),p=i([]),b=async()=>{const{data:a}=await T();p.value=a.list},n=i(!1),d=i("添加角色"),y=a=>{if(a)d.value="编辑角色",g(a);else{d.value="添加角色";for(const e in m)t[e]=m[e]}b(),n.value=!0},g=async a=>{const{data:e}=await F({id:a});for(const o in t)e[o]!=null&&e[o]!==void 0&&(o==="role"?t[o]=e[o].map(r=>r.id):t[o]=e[o])};_({init:y});const f=i(null),k={role:[{required:!0,message:"必填",type:"error"}],name:[{required:!0,message:"必填",type:"error"}]},w=v,V=async()=>{const a=await f.value.validate();if(typeof a!="object"&&a)try{const e=await S(t);if(e.code!==1){u.error(e.msg);return}u.success("操作成功"),n.value=!1,w("success")}catch(e){u.error(e.msg)}};return(a,e)=>{const o=M,r=O,D=B,R=q,x=C;return A(),I(x,{visible:n.value,"onUpdate:visible":e[2]||(e[2]=l=>n.value=l),"close-on-overlay-click":!1,"destroy-on-close":!0,header:d.value,"on-confirm":V},{default:c(()=>[s(R,{ref_key:"formRef",ref:f,"label-align":"left",data:t,rules:k,"label-width":80},{default:c(()=>[s(r,{label:"上级角色",name:"pid"},{default:c(()=>[s(o,{modelValue:t.pid,"onUpdate:modelValue":e[0]||(e[0]=l=>t.pid=l),placeholder:"请选择上级角色",data:p.value,clearable:"",filterable:"","check-strictly":"","min-collapsed-num":2},null,8,["modelValue","data"])]),_:1}),s(r,{label:"角色名",name:"name"},{default:c(()=>[s(D,{modelValue:t.name,"onUpdate:modelValue":e[1]||(e[1]=l=>t.name=l),clearable:"",placeholder:"请输入角色名"},null,8,["modelValue"])]),_:1})]),_:1},8,["data"])]),_:1},8,["visible","header"])}}});export{J as _};
