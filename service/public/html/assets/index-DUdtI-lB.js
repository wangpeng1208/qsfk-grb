import{i as v,d as k,e as l,k as D,l as K,f as P,o as u,c as f,w as h,g as d,a as _,h as T,b as z,p as N,t as R,n as V,u as I,D as M,M as g,B as $}from"./index-CpJFga7x.js";import{p as q}from"./global-DaymibWd.js";import{_ as A}from"./search.vue_vue_type_script_setup_true_lang-CX_MjiT3.js";import{T as E}from"./index-DJO90WwP.js";import{C as F}from"./index-DJSz0Bsf.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./search-DXIN59Oa.js";import"./index-B4p2E3Fl.js";import"./index--0mKpQel.js";import"./useLengthLimit-OjWIxDWr.js";import"./log-ZJhmUOBa.js";import"./useReadonly-Bx8TEnun.js";import"./const-BD0RkfTU.js";import"./useVModel-CzdLJ13E.js";import"./useResizeObserver-ONY0TviC.js";import"./dep-d524834c-s9Vwwbzr.js";import"./browse-CF75H87A.js";import"./close-circle-filled-1kZBSjap.js";import"./index-jBP3p80B.js";import"./dep-86139c71-Dc2HrHYK.js";import"./form-model-ChnUeRwN.js";import"./dep-4cc4ef27-DQG4x64P.js";import"./dep-40320ba3-B1Ayvxeb.js";import"./index-DN3cI5Ry.js";import"./dep-96cefb8b-hs2i3_dz.js";import"./index-DnrQMYJZ.js";import"./index-BcRf9bEE.js";import"./dep-02de0cb4-9NqRuOAE.js";import"./useDefaultValue-BJZ6w0Fl.js";import"./index-BRf9TXQS.js";import"./common-CF_MvV9u.js";import"./index-BqrdyjaG.js";import"./index-Dhx8Vlw0.js";import"./useCommonClassName-DGbYtLoH.js";import"./number--X5gY8kS.js";import"./index-DePaE_yS.js";import"./index-Dk9r_Pa_.js";import"./observe-CfjnoQGd.js";import"./slot-DL8tHB3s.js";import"./chevron-left-BX4tOZyG.js";import"./chevron-right-DSRNsGLo.js";import"./index-fiMfjcvP.js";import"./index-byKPUDsR.js";import"./dep-eedf0c29-v-LgRmZs.js";import"./useVirtualScrollNew-XoyDLD8W.js";import"./dep-af55fe23-3nGiADk5.js";import"./index-D7oq8DY2.js";import"./helper-DkMMPY9i.js";import"./dep-1858b432-D8vbiQ_j.js";function j(o){return v.post({url:"/adminapi/permission/log/list",params:o})}function G(o){return v.post({url:"/adminapi/permission/log/delBatch",params:o})}const H=[{colKey:"id",type:"multiple"},{colKey:"username",title:"用户名"},{colKey:"action",title:"访问链接",ellipsis:!0},{colKey:"params",title:"请求参数",ellipsis:!0},{colKey:"title",title:"标题",ellipsis:!0,cell(o,e){const i=e.row.content.split(", 结果：");return o("span",i[0])}},{colKey:"result",title:"结果",ellipsis:!0,cell(o,e){const i=e.row.content.split(", 结果：");return o("span",i[1])}},{colKey:"ip",title:"IP"},{colKey:"create_at",title:"日志时间",width:"160px"}],J={class:"category-header c-flex"},L={class:"category-header c-flex"},O={class:"l"},Q={key:0,class:"selected-count"},W=k({__name:"index",setup(o){const e=l([]),i=t=>{e.value=t},y=async()=>{const t=M({header:"提醒",body:"是否确认删除？",confirmBtn:"确认",onConfirm:()=>{t.hide();const s={ids:e.value};G(s).then(r=>{r.code===1?(n(),g.success(r.msg),e.value=[]):g.error(r.msg)})},onClose:()=>{t.hide()}})},a=l({defaultPageSize:20,total:0,defaultCurrent:1}),c=l([]),p=l(!1),m=l(),n=async(t={})=>{m.value={...t},p.value=!0;const{data:s}=await j({page:a.value.defaultCurrent,limit:a.value.defaultPageSize,...m.value});c.value=s.list,a.value.total=s.total,p.value=!1};n();const x=t=>{a.value.defaultCurrent=t.current,a.value.defaultPageSize=t.pageSize,n(m.value)},C=D(),b=K(()=>({offsetTop:C.isUseTabsRouter?48:0,container:`.${q}-layout`}));return(t,s)=>{const r=$,w=E,B=F,S=P("perms");return u(),f(B,{title:"后台操作日志",class:"basic-container",bordered:!1},{default:h(()=>[d("div",J,[_(A,{ref:"searchFormRef",onSuccess:n},null,512)]),d("div",L,[d("div",O,[T((u(),f(r,{theme:"default",disabled:!e.value.length,onClick:y},{default:h(()=>[z(" 批量删除 ")]),_:1},8,["disabled"])),[[S,["adminapi/permission/log/delBatch"]]]),e.value.length?(u(),N("p",Q,"已选"+R(e.value.length)+"项",1)):V("",!0)])]),_(w,{ref:"tableRef","row-key":"id",data:c.value,columns:I(H),hover:c.value.length>0,"header-affixed-top":b.value,pagination:a.value,"lazy-load":"","max-height":"100%","selected-row-keys":e.value,onPageChange:x,onSelectChange:i,loading:p.value},null,8,["data","columns","hover","header-affixed-top","pagination","selected-row-keys","loading"])]),_:1})}}}),Je=U(W,[["__scopeId","data-v-44583a82"]]);export{Je as default};
