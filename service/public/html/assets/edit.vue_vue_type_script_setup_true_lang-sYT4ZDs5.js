import{d as O,e as A}from"./admin-CYxxGWts.js";import{l as M}from"./role-D3Xq-rp3.js";import{_ as S}from"./index.vue_vue_type_script_setup_true_lang-Cg72tuK8.js";import{d as q,r as B,e as i,o as C,c as E,w as m,a as l,M as p}from"./index-Dys89YLq.js";import{I as N}from"./index-k_yBcVp0.js";import{F as P,a as T}from"./index-BYoZ1jRX.js";import{I as h}from"./index-xCa1PnD5.js";import{R as j}from"./index-Q2T2ZnL7.js";import{D as G}from"./index-9wlLuihG.js";const L={name:"AdminEditPopup"},ee=q({...L,emits:["success"],setup($,{expose:f,emit:_}){const u={username:"",nickname:"",password:"",avatar:"",email:"",mobile:"",id:"",status:1},b=[{label:"正常",value:1},{label:"禁用",value:0}],a=B({...u}),v=({name:t,url:e})=>{a[t]=e},V=i([]),g=async()=>{const{data:t}=await M();V.value=t.list},r=i(!1),d=i("添加管理员"),y=t=>{if(t)d.value="编辑管理员",w(t);else{d.value="添加管理员";for(const e in u)a[e]=u[e]}g(),r.value=!0},w=async t=>{const{data:e}=await O({id:t});for(const s in a)e[s]!=null&&e[s]!==void 0&&(s==="role"?a[s]=e[s].map(n=>n.id):a[s]=e[s])};f({init:y});const c=i(null),k={role:[{required:!0,message:"必填",type:"error"}],username:[{required:!0,message:"必填",type:"error"}]},U=_,R=async()=>{const t=await c.value.validate();if(typeof t!="object"&&t)try{const e=await A(a);e.code===1?(p.success("操作成功"),r.value=!1,U("success")):p.error(e.msg)}catch(e){p.error(e.msg)}};return(t,e)=>{const s=N,n=P,I=h,x=j,D=T,F=G;return C(),E(F,{visible:r.value,"onUpdate:visible":e[6]||(e[6]=o=>r.value=o),"close-on-overlay-click":!1,"destroy-on-close":!0,header:d.value,"on-confirm":R},{default:m(()=>[l(D,{ref_key:"formRef",ref:c,"label-align":"left",data:a,rules:k,"label-width":80},{default:m(()=>[l(n,{label:"用户名",name:"username"},{default:m(()=>[l(s,{modelValue:a.username,"onUpdate:modelValue":e[0]||(e[0]=o=>a.username=o),clearable:"",placeholder:"请输入管理员用户名"},null,8,["modelValue"])]),_:1}),l(n,{label:"昵称",name:"nickname"},{default:m(()=>[l(s,{modelValue:a.nickname,"onUpdate:modelValue":e[1]||(e[1]=o=>a.nickname=o),clearable:"",placeholder:"请输入昵称"},null,8,["modelValue"])]),_:1}),l(n,{label:"密码",name:"password"},{default:m(()=>[l(s,{modelValue:a.password,"onUpdate:modelValue":e[2]||(e[2]=o=>a.password=o),clearable:"",placeholder:"留空则不更改"},null,8,["modelValue"])]),_:1}),l(n,{label:"头像",name:"avatar"},{default:m(()=>[l(S,{theme:"image",app:"admin",initial:a,name:"avatar",data:{type:"image"},onUpdate:v},null,8,["initial"])]),_:1}),l(n,{label:"邮箱",name:"email"},{default:m(()=>[l(s,{modelValue:a.email,"onUpdate:modelValue":e[3]||(e[3]=o=>a.email=o),clearable:"",placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),l(n,{label:"手机",name:"mobile"},{default:m(()=>[l(I,{modelValue:a.mobile,"onUpdate:modelValue":e[4]||(e[4]=o=>a.mobile=o),clearable:"",placeholder:"请输入手机",style:{width:"500px"},theme:"column",min:0},null,8,["modelValue"])]),_:1}),l(n,{label:"状态",name:"status"},{default:m(()=>[l(x,{modelValue:a.status,"onUpdate:modelValue":e[5]||(e[5]=o=>a.status=o),options:b},null,8,["modelValue"])]),_:1})]),_:1},8,["data"])]),_:1},8,["visible","header"])}}});export{ee as _};
