import{u as f}from"./image-23uimPBY.js";import{b as N,e as S}from"./category-DQvQx6ik.js";import{d as j,r as _,e as u,l as M,j as W,o as q,c as E,w as n,a,g as T,M as c}from"./index-Dys89YLq.js";import{I as $}from"./index-k_yBcVp0.js";import{F as z,a as A}from"./index-BYoZ1jRX.js";import{I as G}from"./index-xCa1PnD5.js";import{D as H}from"./index-9wlLuihG.js";const J={name:"CategoryEditPopup"},ee=j({...J,emits:["success","close"],setup(K,{expose:g,emit:b}){const d={id:"",name:"",pic:"",bg_pic:"",status:1,is_show:1,sort:""},t=_({...d}),r=u("add"),v=M(()=>r.value==="edit"?"编辑分类":"新增分类"),h=u(!1),m=u(!1),x=(o="add")=>{if(r.value=o,m.value=!0,o==="add")for(const e in t)t[e]=d[e]},y=async o=>{r.value="edit";for(const e in t)o[e]!=null&&o[e]!==void 0&&(t[e]=o[e]);console.log(t)},s=_({content:"保存",loading:!1}),w=b,p=u(null),V={name:[{required:!0,message:"请输入分类名称",type:"error"}]},k=async()=>{const o=await p.value.validate();if(typeof o!="object"&&o){s.content="保存中...",s.loading=!0;try{const e=r.value==="add"?await N(t):await S(t);e.code===1?(c.success("操作成功"),m.value=!1,w("success")):c.error(`操作失败：${e.msg}`)}catch{c.error("操作失败")}finally{s.content="保存",s.loading=!1}}};g({open:x,getDetail:y});const I=o=>{t.pic=o},P=o=>{t.bg_pic=o};return(o,e)=>{const B=$,i=z,C=W("wp-check-tag"),D=G,F=A,U=H;return q(),E(U,{visible:m.value,"onUpdate:visible":e[3]||(e[3]=l=>m.value=l),loading:h.value,"destroy-on-close":!0,"close-on-overlay-click":!1,header:v.value,draggable:"","confirm-btn":s,"on-confirm":k,width:"500px"},{default:n(()=>[a(F,{ref_key:"form",ref:p,data:t,rules:V,"label-width":"150","label-align":"left"},{default:n(()=>[a(i,{label:"分类名称",name:"name",tips:"输入分类名称"},{default:n(()=>[a(B,{modelValue:t.name,"onUpdate:modelValue":e[0]||(e[0]=l=>t.name=l),placeholder:"请输入分类名称","show-limit-number":"",minlength:2},null,8,["modelValue"])]),_:1}),a(i,{label:"分类图标",name:"pic",tips:"建议180*180"},{default:n(()=>[a(f,{url:t.pic,title:"分类图标",style:{maxWidth:"100px",width:"100px",height:"100px"},maxlength:1,onSetPic:I},null,8,["url"])]),_:1}),a(i,{label:"分类大图",name:"bg_pic",tips:"建议468*340"},{default:n(()=>[a(f,{url:t.bg_pic,title:"分类大图",style:{maxWidth:"100px",width:"100px",height:"100px"},maxlength:1,onSetPic:P,opt:""},null,8,["url"])]),_:1}),a(i,{label:"栏目状态",name:"status",tips:""},{default:n(()=>[T("span",null,[a(C,{modelValue:t.status,"onUpdate:modelValue":e[1]||(e[1]=l=>t.status=l),items:[{label:"上架",value:1},{label:"隐藏",value:0}]},null,8,["modelValue"])])]),_:1}),a(i,{label:"分类排序",name:"sort",tips:"填写数字越大，显示越靠前。"},{default:n(()=>[a(D,{modelValue:t.sort,"onUpdate:modelValue":e[2]||(e[2]=l=>t.sort=l),theme:"column",min:0},null,8,["modelValue"])]),_:1})]),_:1},8,["data"])]),_:1},8,["visible","loading","header","confirm-btn"])}}});export{ee as _};
